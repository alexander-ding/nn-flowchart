(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{144:function(e,t,a){},146:function(e,t,a){},147:function(e,t,a){"use strict";a.r(t);var n=a(20),r=a.n(n),l=a(0),i=a.n(l),s=a(7),o=a(21),c=a(11),u=a(2),d=a(3),p=a(5),m=a(4),h=a(6),f=a(1),b=a(33),g=a.n(b),v=(a(63),a(10)),E=20,y="#cccccc";var k={dense:{name:"Dense",type:"layer",svg:function(e){var t,a=Object(s.a)(Array(3)).map(function(e,t){return i.a.createElement("circle",{cx:20,cy:24*(t+.5)+4,key:t,r:80/3/2-4,fill:"#83a5f7"})});return t=null!=e.activation?k[e.activation].svg(20,80+E/2+3):null,i.a.createElement(i.a.Fragment,null,i.a.createElement("rect",{width:40,height:80,fill:"#665cf9"}),i.a.createElement("rect",{width:40,y:80,height:E,fill:y}),a,t)},offsetX:20,offsetY:50,defaultParameters:{units:16},canActivation:!0,shapeOut:function(e,t,a){return null===t?null:[].concat(Object(s.a)(t.slice(0,t.length-1)),[e.units])}},conv:{name:"Conv",type:"layer",svg:function(e){var t;return t=null!=e.activation?k[e.activation].svg(40,60+E/2+3):null,i.a.createElement(i.a.Fragment,null,i.a.createElement("rect",{width:40,height:40,fill:"#2775f4"}),i.a.createElement("rect",{x:10,y:10,width:40,height:40,fill:"#4286f4"}),i.a.createElement("rect",{x:20,y:20,width:40,height:40,fill:"#5c98f9"}),i.a.createElement("rect",{x:20,y:60,width:40,height:E,fill:y}),t)},offsetX:40,offsetY:40,defaultParameters:{filters:8,kernelSize:[3,3],stride:1},canActivation:!0,shapeOut:function(e,t,a){if(null===t)return null;var n=t[0],r=t.slice(1,t.length-1),l=Object(v.isArray)(e.kernelSize)?e.kernelSize:[e.kernelSize],i="number"===typeof e.stride?Array(l.length).fill(e.stride):e.stride,o=e.filters;if(r.length!==l.length)return a("Kernel must have the same ndim as the input dimension (without batchSize)",!1),null;var c=r.map(function(e,t){return Math.floor((e-l[t])/i[t])+1});return[n].concat(Object(s.a)(c),[o])}},input:{name:"Input",type:"layer",svg:function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("rect",{width:30,height:30,fill:"#99ccff"}))},offsetX:15,offsetY:15,defaultParameters:{data:"MNIST",datasetID:"",inputShape:[28,28,1]},canActivation:!1,shapeOut:function(e,t,a){return null===e.inputShape?null:Object(v.isArray)(e.inputShape)?[Number(t.batchSize)].concat(Object(s.a)(e.inputShape)):[Number(t.batchSize),e.inputShape]}},maxpool:{name:"Max Pool",type:"layer",svg:function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("rect",{width:30,height:30,fill:"#be41f4"}),i.a.createElement("rect",{x:7.5,y:7.5,width:30,height:30,fill:"#e541f4"}),i.a.createElement("rect",{x:15,y:15,width:30,height:30,fill:"#f95cf9"}))},offsetX:30,offsetY:30,defaultParameters:{poolSize:[2,2]},canActivation:!1,shapeOut:function(e,t,a){if(null===t)return null;var n=t[0],r=t.slice(1,t.length-1),l=t[t.length-1],i="number"===typeof e.poolSize?[e.poolSize]:e.poolSize;if(r.length!==i.length)return a("PoolSize must have the same ndim as the input dimension (without batchSize)",!1),null;var o=r.map(function(e,t){return Math.floor(e/i[t])});return[n].concat(Object(s.a)(o),[l])}},embedding:{name:"Embedding",type:"layer",svg:function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("rect",{width:60,height:15,fill:"#6a41f4"}),i.a.createElement("rect",{width:30,height:15,y:15,fill:"#8a61ff"}),i.a.createElement("rect",{width:50,height:15,y:30,fill:"#7a51f5"}))},offsetX:25,offsetY:20,defaultParameters:{units:100},canActivation:!1,shapeOut:function(e,t,a){return null===t?null:Object(v.isNumber)(t)||2!==t.length?(a("Embedding input shape must be (batchSize, sequenceLength)",!1),null):[t[0],t[1],e.units]}},dropout:{name:"Dropout",type:"layer",svg:function(e){var t="#404040";return i.a.createElement(i.a.Fragment,null,i.a.createElement("rect",{width:10,height:10,x:0,y:0,fill:t}),i.a.createElement("rect",{width:10,height:10,x:20,y:0,fill:t}),i.a.createElement("rect",{width:10,height:10,x:30,y:0,fill:t}),i.a.createElement("rect",{width:10,height:10,x:10,y:10,fill:t}),i.a.createElement("rect",{width:10,height:10,x:20,y:10,fill:t}),i.a.createElement("rect",{width:10,height:10,x:0,y:20,fill:t}),i.a.createElement("rect",{width:10,height:10,x:20,y:20,fill:t}),i.a.createElement("rect",{width:10,height:10,x:30,y:20,fill:t}),i.a.createElement("rect",{width:10,height:10,x:10,y:30,fill:t}),i.a.createElement("rect",{width:10,height:10,x:20,y:30,fill:t}),i.a.createElement("rect",{width:10,height:10,x:30,y:30,fill:t}))},offsetX:20,offsetY:20,defaultParameters:{rate:.25},canActivation:!1,shapeOut:function(e,t,a){return null===t?null:t}},flatten:{name:"Flatten",type:"layer",svg:function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("rect",{width:16,height:120,fill:"#404040"}))},offsetX:8,offsetY:60,defaultParameters:{},canActivation:!1,shapeOut:function(e,t,a){return null===t?null:Object(v.isNumber)(t)||t.length<=2?(a("Flatten input shape must be (batchSize, ...shape) (ndim > 2)",!1),null):[t[0],t.slice(1).reduce(function(e,t){return e*t})]}},output:{name:"Output",type:"layer",svg:function(e){var t;return t=null!=e.activation?k[e.activation].svg(15,60+E/2+3):null,i.a.createElement(i.a.Fragment,null,i.a.createElement("rect",{width:30,height:60,fill:"#008066"}),i.a.createElement("rect",{width:30,y:60,height:E,fill:y}),t)},offsetX:10,offsetY:40,defaultParameters:{data:"MNIST",outputShape:[10]},canActivation:!0,shapeOut:function(e,t,a){return null===t?null:((Object(v.isNumber)(t)||2!==t.length)&&a("Output layer must have input layer of shape (batchSize, dim)",!1),Object(v.isArray)(e.outputShape)?[].concat(Object(s.a)(t.slice(0,t.length-1)),Object(s.a)(e.outputShape)):[].concat(Object(s.a)(t.slice(0,t.length-1)),[e.outputShape]))}},relu:{name:"ReLU",type:"activation",svg:function(e,t){return i.a.createElement(i.a.Fragment,null,i.a.createElement("path",{d:"M"+(e-12)+" "+t+"l12 0 l12 -8",stroke:"black",strokeWidth:"2",fill:"none"}))},defaultParameters:{}},sigmoid:{name:"Sigmoid",type:"activation",svg:function(e,t){return i.a.createElement("path",{d:"M "+(e-12)+" "+t+" q 11 0 12 "+-4+" q 1 "+-4+" 12 "+-4,stroke:"black",strokeWidth:"2",fill:"none"})},defaultParameters:{}},tanh:{name:"Tanh",type:"activation",svg:function(e,t){return i.a.createElement("path",{d:"M "+(e-12)+" "+t+" q 7 0 12 "+-4+" q 5 "+-4+" 12 "+-4,stroke:"black",strokeWidth:"2",fill:"none"})},defaultParameters:{}},softmax:{name:"SoftMax",type:"activation",svg:function(e,t){return i.a.createElement("path",{d:"M "+(e-12)+" "+t+" q 23 0 24 "+-8,stroke:"black",strokeWidth:"2",fill:"none"})},defaultParameters:{}}},O=["dense","conv","maxpool","flatten","embedding","dropout"],S=["relu","sigmoid","softmax","tanh"],N=JSON.parse('{"0":{"name":"input0","ID":0,"type":"input","x":20,"y":50,"connectedTo":null,"shapeIn":null,"shapeOut":[25,28,28,1],"activation":null,"parameters":{"data":"MNIST","batchSize":25, "inputShape":[28,28,1]}},"1":{"name":"output1","ID":1,"type":"output","x":299,"y":50,"connectedTo":null,"shapeIn":[25,16],"shapeOut":[25,10],"activation":"sigmoid","parameters":{"data":"MNIST", "outputShape":[10]}}}'),j=JSON.parse('{"0":{"name":"input0","ID":0,"type":"input","x":20,"y":50,"connectedTo":2,"shapeIn":null,"shapeOut":[25,28,28,1],"activation":null,"parameters":{"data":"MNIST","batchSize":25, "inputShape":[28,28,1]}},"1":{"name":"output1","ID":1,"type":"output","x":299,"y":50,"connectedTo":null,"shapeIn":[25,16],"shapeOut":[25,10],"activation":"sigmoid","parameters":{"data":"MNIST", "outputShape":[10]}},"2":{"name":"conv2","ID":2,"type":"conv","x":74.28643321494462,"y":46.87875586829372,"connectedTo":3,"shapeIn":[25,28,28,1],"shapeOut":[25,25,25,8],"activation":"relu","parameters":{"filters":8,"kernelSize":[3,3],"stride":1}},"3":{"name":"maxpool3","ID":3,"type":"maxpool","x":153.58841744957806,"y":55.21242239191861,"connectedTo":4,"shapeIn":[25,25,25,8],"shapeOut":[25,12,12,8],"activation":null,"parameters":{"poolSize":[2,2]}},"4":{"name":"dense4","ID":4,"type":"dense","x":219.28041809853335,"y":37.307656195514426,"connectedTo":1,"shapeIn":[25,12,12,8],"shapeOut":[25,16],"activation":"relu","parameters":{"units":16}}}'),I=JSON.parse('{"0":{"name":"input0","ID":0,"type":"input","x":20,"y":50,"connectedTo":3,"shapeIn":null,"shapeOut":[25,28,28,1],"activation":null,"parameters":{"data":"MNIST","batchSize":25}},"1":{"name":"output1","ID":1,"type":"output","x":299,"y":50,"connectedTo":null,"shapeIn":[25,16],"shapeOut":[25,10],"activation":"sigmoid","parameters":{"data":"MNIST"}},"2":{"name":"dense2","ID":2,"type":"dense","x":191.61521311914112,"y":41.56822923585631,"connectedTo":1,"shapeIn":[25,16],"shapeOut":[25,16],"activation":"relu","parameters":{"units":16}},"3":{"name":"dense3","ID":3,"type":"dense","x":107.9840483926111,"y":39.51253484832063,"connectedTo":2,"shapeIn":[25,28,28,1],"shapeOut":[25,16],"activation":"relu","parameters":{"units":16}}}');function M(e){return i.a.createElement("div",{className:"sidebar-header"},i.a.createElement("button",{type:"button",className:"edit"===e.tabSelected?"btn btn-dark btn-block":"btn btn-outline-dark btn-block",onClick:function(){return e.changeTab("edit")}},"Edit"),i.a.createElement("button",{type:"button",className:"train"===e.tabSelected?"btn btn-dark btn-block":"btn btn-outline-dark btn-block",onClick:function(){return e.changeTab("train")}},"Train"))}function w(){return i.a.createElement("ul",{className:"list-unstyled CTAs"},i.a.createElement("li",null,i.a.createElement("a",{href:"https://www.github.com/alexding123/NN-Flowchart",className:"download"},"Download source")))}function C(e){return i.a.createElement("div",{className:"p-2 align-self-stretch button-container"},i.a.createElement("button",{className:"btn btn-sm btn-dark btn-block",onClick:e.onClick,disabled:e.disabled},e.children))}function D(e){return i.a.createElement(C,{onClick:function(){return e.newModel(e.name)}},k[e.name].name)}function x(e){return i.a.createElement(C,{onClick:function(){return e.newActivation(e.name)}},k[e.name].name)}var T=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(m.a)(t).call(this,e))).props=e,a.propsOri=e.propsOri,a.setActivation=a.setActivation.bind(Object(f.a)(Object(f.a)(a))),a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"setActivation",value:function(e){if(-1!==this.props.selected){var t=this.props.models[this.props.selected];k[t.type].canActivation&&(t.activation===e?this.props.update(this.props.selected,{activation:null}):this.props.update(this.props.selected,{activation:e}))}else this.props.setError("Select a layer to add the activation to first!",!0)}},{key:"render",value:function(){var e=this;return i.a.createElement(i.a.Fragment,null,i.a.createElement(g.a,{trigger:"Layers",triggerTagName:"p",id:"layers-toggle",triggerClassName:"trigger",triggerOpenedClassName:"trigger active",onOpen:function(){return e.propsOri.update("layers",!1)},onClose:function(){return e.propsOri.update("layers",!0)},open:!this.propsOri.layersCollapsed},i.a.createElement("div",{className:"d-flex flex-column"},O.map(function(t){return i.a.createElement(D,{key:t,name:t,newModel:e.props.newModel})}))),i.a.createElement(g.a,{trigger:"Activations",triggerTagName:"p",triggerClassName:"trigger",triggerOpenedClassName:"trigger active",onOpen:function(){return e.propsOri.update("activations",!1)},onClose:function(){return e.propsOri.update("activations",!0)},open:!this.propsOri.activationsCollapsed},i.a.createElement("div",{className:"d-flex flex-column"},S.map(function(t){return i.a.createElement(x,{key:t,name:t,newActivation:function(){return e.setActivation(t)}})}))))}}]),t}(i.a.Component);function L(e){var t=e.props,a=t.trainingInfo.training,n=a?i.a.createElement(C,{onClick:t.cancelTrain},"Cancel"):i.a.createElement(C,{onClick:t.trainCloud},"Train on Cloud");return i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,"Server"),i.a.createElement(C,{onClick:t.setSelectModelPage,disabled:a},"New/Load"),i.a.createElement(C,{onClick:t.getLink},"Generate Link"),i.a.createElement("p",null,"Model"),n,i.a.createElement(C,{onClick:t.downloadModel},"Download Model"),i.a.createElement("p",null,"Input"),i.a.createElement(C,{onClick:t.setInput},"Set Input"))}function A(e){var t=e.props,a="edit"===e.tabSelected?i.a.createElement(T,{propsOri:e,models:t.models,selected:t.selected,setError:t.setError,newModel:t.newModel,update:t.update}):i.a.createElement(L,{props:t});return i.a.createElement("ul",{className:"list-unstyled components"},a)}var P=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(m.a)(t).call(this,e))).props=e,a.state={tabSelected:"edit",layersCollapsed:!1,activationsCollapsed:!1},a.changeTab=a.changeTab.bind(Object(f.a)(Object(f.a)(a))),a.set=a.set.bind(Object(f.a)(Object(f.a)(a))),a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"set",value:function(e,t){"layers"===e?this.setState({layersCollapsed:t}):"activations"===e&&this.setState({activationsCollapsed:t})}},{key:"changeTab",value:function(e){this.setState({tabSelected:e})}},{key:"render",value:function(){return i.a.createElement("nav",{className:"p-2 h-100",id:"sidebar"},i.a.createElement(M,{tabSelected:this.state.tabSelected,changeTab:this.changeTab}),i.a.createElement(A,{tabSelected:this.state.tabSelected,layersCollapsed:this.state.layersCollapsed,activationsCollapsed:this.state.activationsCollapsed,update:this.set,props:this.props}),i.a.createElement(w,null))}}]),t}(i.a.Component),z=a(34),F=(a(67),function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(m.a)(t).call(this,e))).props=e,a.onMouseDown=a.onMouseDown.bind(Object(f.a)(Object(f.a)(a))),a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"onMouseDown",value:function(e){var t=this.props.model;this.props.handleDrag(e.clientX,e.clientY,t.ID)}},{key:"render",value:function(){var e=this.props.model;return i.a.createElement("g",{className:this.props.selected?"selected":"",onMouseDown:this.onMouseDown,key:e.ID,transform:"translate("+String(e.x)+","+String(e.y)+")",style:{userSelect:"none"}},k[e.type].svg(e))}}]),t}(i.a.Component));function B(e){return i.a.createElement("defs",null,i.a.createElement("marker",{id:"dot",viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"5",markerHeight:"5"},i.a.createElement("circle",{cx:"5",cy:"5",r:"3",fill:"black"})),i.a.createElement("marker",{id:"arrow",markerWidth:"4",markerHeight:"4",orient:"auto",refY:"2"},i.a.createElement("path",{d:"M0,0 L4,2 0,4"})))}function J(e){var t=e.tentative?"5,5":null,a=e.selected?"selected":null,n=e.tentative?null:e.onClick,r=e.tentative?"none":null;"pointerEvents"in e&&(r=e.pointerEvents);var l=(e.x1+e.x2)/2,s=(e.y1+e.y2)/2;return i.a.createElement("path",{d:"M "+e.x1+" "+e.y1+" L "+l+" "+s+" L "+e.x2+" "+e.y2,onClick:n,className:a,pointerEvents:r,strokeDasharray:t,stroke:"black",strokeWidth:"3",markerStart:"url(#arrow)",markerMid:"url(#arrow)",markerEnd:"url(#dot)"})}var Y="https://nn-flowchart.herokuapp.com/api/",X={MNIST:{input:[28,28,1],output:[10]},IMDB:{input:[500],output:[2]}};function U(e){var t=k[e.type].offsetX,a=k[e.type].offsetY;return{x:e.x+t,y:e.y+a}}var R=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(m.a)(t).call(this,e))).props=e,a.state={isNewline:!1,xOffset:0,yOffset:0,x:0,y:0,id:-1,selectedLineFromTo:[-1,-1],dragging:-1,initX:0,initY:0,initModelX:0,initModelY:0},a.handleElementClick=a.handleElementClick.bind(Object(f.a)(Object(f.a)(a))),a.trackMouse=a.trackMouse.bind(Object(f.a)(Object(f.a)(a))),a.handleBGClick=a.handleBGClick.bind(Object(f.a)(Object(f.a)(a))),a.handleLineClick=a.handleLineClick.bind(Object(f.a)(Object(f.a)(a))),a.deleteSelection=a.deleteSelection.bind(Object(f.a)(Object(f.a)(a))),a.handleDrag=a.handleDrag.bind(Object(f.a)(Object(f.a)(a))),a.onMouseUp=a.onMouseUp.bind(Object(f.a)(Object(f.a)(a))),a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=r.a.findDOMNode(this).getBoundingClientRect();this.setState({xOffset:e.x,yOffset:e.y}),document.addEventListener("keydown",this.deleteSelection)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.deleteSelection)}},{key:"deleteSelection",value:function(e){if(!this.props.editableSelected&&8===e.keyCode){if(-1!==this.props.selected){this.cancelNewline();var t=this.props.selected;if(0===t||1===t)return;return this.props.select(-1),void this.props.remove(t)}var a=this.state.selectedLineFromTo[0],n=this.state.selectedLineFromTo[1];if(-1!==a||-1!==n)return this.cancelNewline(),void this.props.update(a,{connectedTo:null})}}},{key:"startNewline",value:function(e){this.setState({isNewline:!0,id:e,selectedLineFromTo:[-1,-1]})}},{key:"cancelNewline",value:function(){this.setState({isNewline:!1,id:-1,selectedLineFromTo:[-1,-1]})}},{key:"trackMouse",value:function(e){if(this.setState({x:e.clientX-this.state.xOffset,y:e.clientY-this.state.yOffset}),-1!==this.state.dragging){var t=e.clientX+this.state.initModelX-this.state.initX,a=e.clientY+this.state.initModelY-this.state.initY;this.props.update(this.state.dragging,{x:t,y:a})}}},{key:"onMouseUp",value:function(e){if(-1!==this.state.dragging){var t=this.state.dragging,a=this.props.models[t];this.setState({dragging:-1});Math.abs(a.x-this.state.initModelX)+Math.abs(a.y-this.state.initModelY)<10&&(this.props.select(a.ID),this.handleElementClick(a.ID))}}},{key:"handleBGClick",value:function(e){if(e.target===this.refs.canvas)return this.props.select(-1),void this.cancelNewline()}},{key:"handleElementClick",value:function(e){if(this.state.isNewline)return this.state.id!==e&&(this.props.update(this.state.id,{connectedTo:e}),this.props.models[e].connectedTo===this.state.id&&this.props.update(e,{connectedTo:null})),void this.cancelNewline();this.startNewline(e)}},{key:"handleLineClick",value:function(e,t){this.setState({selectedLineFromTo:[e,t]}),this.props.select(-1)}},{key:"handleDrag",value:function(e,t,a){var n=this.props.models[a];this.setState({dragging:a,initX:e,initY:t,initModelX:n.x,initModelY:n.y}),this.props.select(n.ID)}},{key:"render",value:function(){var e=this,t=Object.entries(this.props.models).map(function(t){var a=Object(z.a)(t,2),n=(a[0],a[1]);return i.a.createElement(F,{key:n.ID,handleDrag:e.handleDrag,model:n,selected:e.props.selected===n.ID})}),a=null;if(this.state.isNewline){var n=U(this.props.models[this.state.id]);a=i.a.createElement(J,{tentative:!0,selected:!0,x1:n.x,y1:n.y,x2:this.state.x,y2:this.state.y})}var r=Object.entries(this.props.models).map(function(t){var a=Object(z.a)(t,2),n=a[0],r=a[1];if(null===r.connectedTo)return null;var l=e.props.models[r.connectedTo],s=U(r),o=U(l),c=e.state.selectedLineFromTo[0]===r.ID&&e.state.selectedLineFromTo[1]===l.ID;return i.a.createElement(J,{key:n,tentative:!1,selected:c,x1:s.x,y1:s.y,x2:o.x,y2:o.y,onClick:function(){return e.handleLineClick(r.ID,l.ID)}})});return i.a.createElement("svg",{onClick:this.handleBGClick,onMouseMove:this.trackMouse,onMouseUp:this.onMouseUp,id:"canvas",width:"100%",height:"60%",ref:"canvas"},i.a.createElement(B,null),i.a.createElement("rect",{width:"100%",height:"100%",fill:"#b477ec",pointerEvents:"none"}),t,r,a)}}]),t}(i.a.Component);function _(e){return i.a.createElement("svg",{width:"100%",height:"20%"},i.a.createElement("rect",{width:"100%",height:"100%",fill:"blueviolet"}))}function W(e){return i.a.createElement("div",{className:"p-2 flex-grow-1 canvas-container no-margin"},i.a.createElement(_,null),i.a.createElement(R,{models:e.models,editableSelected:e.editableSelected,selected:e.selected,select:e.select,update:e.update,remove:e.remove}),i.a.createElement(_,null))}a(68);function q(e){return i.a.createElement("div",{className:"parameter-line"},i.a.createElement("div",{className:"parameter-name"},e.name,":"),i.a.createElement("div",{className:"parameter-value"},e.value))}var G=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(m.a)(t).call(this,e))).props=e,a.state={valueChanged:!1,currentValue:null},a.onFocus=function(){return a.props.setEditableSelected(!0)},a.onChange=a.onChange.bind(Object(f.a)(Object(f.a)(a))),a.onBlur=function(e){a.setState({valueChanged:!1,currentValue:null}),a.props.setEditableSelected(!1),a.props.callback(a.props.paraName,e)},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"onChange",value:function(e){var t=e.target.value;this.setState({valueChanged:!0,currentValue:t})}},{key:"render",value:function(){var e=this,t=this.props.parameters[this.props.paraName],a=this.state.valueChanged?this.state.currentValue:t;return i.a.createElement("div",{className:"parameter-line"},i.a.createElement("div",{className:"parameter-name"},this.props.name),i.a.createElement("input",{className:"parameter-input",onFocus:this.onFocus,onBlur:function(){return e.onBlur(a)},onChange:this.onChange,value:a}))}}]),t}(i.a.Component);function V(e){return i.a.createElement("div",{className:"parameter-line"},i.a.createElement("div",{className:"parameter-name"},"Dataset"),i.a.createElement("div",{className:"parameter-input parameter-clickable",onClick:e.setInputDataset},e.value))}function H(e){var t=e.model;if(null===t)return null;switch(t.type){case"dense":return i.a.createElement(i.a.Fragment,null,i.a.createElement(G,{name:"Units",paraName:"units",setEditableSelected:e.setEditableSelected,parameters:t.parameters,callback:function(t,a){return e.callback(t,a,!1)}}));case"conv":return i.a.createElement(i.a.Fragment,null,i.a.createElement(G,{name:"Filters",paraName:"filters",setEditableSelected:e.setEditableSelected,parameters:t.parameters,callback:function(t,a){return e.callback(t,a,!1)}}),i.a.createElement(G,{name:"Kernel Size",paraName:"kernelSize",setEditableSelected:e.setEditableSelected,parameters:t.parameters,callback:function(t,a){return e.callback(t,a,!0)}}),i.a.createElement(G,{name:"Stride",paraName:"stride",setEditableSelected:e.setEditableSelected,parameters:t.parameters,callback:function(t,a){return e.callback(t,a,!0)}}));case"input":return i.a.createElement(i.a.Fragment,null,i.a.createElement(V,{value:t.parameters.data,setInputDataset:e.setInputDataset}));case"maxpool":return i.a.createElement(i.a.Fragment,null,i.a.createElement(G,{name:"Pool Size",paraName:"poolSize",setEditableSelected:e.setEditableSelected,parameters:t.parameters,callback:function(t,a){return e.callback(t,a,!0)}}));case"embedding":return i.a.createElement(i.a.Fragment,null,i.a.createElement(G,{name:"Units",paraName:"units",setEditableSelected:e.setEditableSelected,parameters:t.parameters,callback:function(t,a){return e.callback(t,a,!1)}}));case"dropout":return i.a.createElement(i.a.Fragment,null,i.a.createElement(G,{name:"Rate",paraName:"rate",setEditableSelected:e.setEditableSelected,parameters:t.parameters,callback:function(t,a){return e.callback(t,a,!1,!0)}}));default:return null}}function K(e){if(-1===e.selected){var t=e.modelInfo,a=e.trainingInfo,n=null===a.loss?"N/A":a.loss,r=null===a.accuracy?"N/A":a.accuracy,l=null===a.testAccuracy?"N/A":a.testAccuracy,s=null===a.progress?"0.0%":a.progress;return i.a.createElement("nav",{className:"p-2 no-margin",id:"toolbar"},i.a.createElement("div",{id:"toolbar-container"},i.a.createElement("div",{className:"left-line"},i.a.createElement("p",null,"Model Information"),i.a.createElement(G,{name:"Epochs",paraName:"epochs",setEditableSelected:function(){return null},parameters:t,callback:function(t,a){return e.updateModelInfo(t,a,!0)}}),i.a.createElement(G,{name:"Batch Size",paraName:"batchSize",setEditableSelected:function(){return null},parameters:t,callback:function(t,a){return e.updateModelInfo(t,a,!0)}}),i.a.createElement("button",{onClick:e.trainSetup,className:"btn btn-sm btn-light btn-block"},"More")),i.a.createElement("div",{className:"blocker"}),i.a.createElement("div",{className:"middle-line"},i.a.createElement("p",null,"Train Information"),i.a.createElement(q,{name:"Training",value:a.training?"Yes":"No"}),i.a.createElement(q,{name:"Progress",value:s})),i.a.createElement("div",{className:"blocker"}),i.a.createElement("div",{className:"right-line"},i.a.createElement("br",null),i.a.createElement(q,{name:"Accuracy",value:r}),i.a.createElement(q,{name:"Loss",value:n}),i.a.createElement(q,{name:"Test Acc",value:l}))))}var o=e.models[e.selected],c=k[o.type].name,u=null===o.activation?"None":k[o.activation].name,d=null===o.shapeIn?"N/A":String(o.shapeIn),p=null===o.shapeOut?"N/A":String(o.shapeOut);return i.a.createElement("nav",{className:"p-2 no-margin",id:"toolbar"},i.a.createElement("div",{id:"toolbar-container"},i.a.createElement("div",{className:"left-line"},i.a.createElement("p",null,"Parameters"),i.a.createElement(H,{model:o,callback:e.update,setEditableSelected:e.setEditableSelected,setInputDataset:e.setInputDataset})),i.a.createElement("div",{className:"blocker"}),i.a.createElement("div",{className:"middle-line"},i.a.createElement("p",null,"Layer Information"),i.a.createElement(q,{name:"Type",value:c}),i.a.createElement(q,{name:"Activation",value:u})),i.a.createElement("div",{className:"blocker"}),i.a.createElement("div",{className:"right-line"},i.a.createElement("br",null),i.a.createElement(q,{name:"Shape In",value:d}),i.a.createElement(q,{name:"Shape Out",value:p}))))}a(69);function Q(e){return null===e.errorMsg?null:e.dismissible?i.a.createElement("div",{className:"position-absolute float-box"},i.a.createElement("div",{className:"alert alert-danger alert-dismissible position-absolute w-100"},i.a.createElement("strong",null,"Error:")," ",e.errorMsg,i.a.createElement("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close",onClick:function(){return e.setError(null,!0)}},i.a.createElement("span",{"aria-hidden":"true"},"\xd7")))):i.a.createElement("div",{className:"position-absolute float-box"},i.a.createElement("div",{className:"alert alert-danger position-absolute w-100"},i.a.createElement("strong",null,"Error:")," ",e.errorMsg))}a(70);var Z=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(m.a)(t).call(this,e))).props=e,a.state={err:null,link:null},a.onChange=a.onChange.bind(Object(f.a)(Object(f.a)(a))),a.noChange=a.noChange.bind(Object(f.a)(Object(f.a)(a))),a.loadModel=a.loadModel.bind(Object(f.a)(Object(f.a)(a))),a.setError=a.setError.bind(Object(f.a)(Object(f.a)(a))),a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"setError",value:function(e){this.setState({err:e})}},{key:"loadModel",value:function(){this.props.loadModel(this.state.link,this.setError)}},{key:"onChange",value:function(e){this.setState({link:e.target.value})}},{key:"noChange",value:function(e){"background-model-select"!==e.target.id&&"model-blocker"!==e.target.id||this.props.toggle()}},{key:"render",value:function(){var e=this;return this.props.display?i.a.createElement("div",{id:"background-model-select",onClick:this.noChange,className:"select-model-container"},i.a.createElement("h1",null,"Load a Model"),i.a.createElement("div",{className:"model-container"},i.a.createElement("div",{className:"model-new"},i.a.createElement("h2",null,"New Model"),i.a.createElement("div",{className:"d-flex flex-wrap p-2"},i.a.createElement("div",{className:"p-2"},i.a.createElement("button",{type:"button",onClick:function(){return e.props.loadDefaultModel("blank")},className:"btn btn-secondary"},"Blank")),i.a.createElement("div",{className:"p-2"},i.a.createElement("button",{type:"button",onClick:function(){return e.props.loadDefaultModel("dense")},className:"btn btn-secondary"},"Dense")),i.a.createElement("div",{className:"p-2"},i.a.createElement("button",{type:"button",onClick:function(){return e.props.loadDefaultModel("conv")},className:"btn btn-secondary"},"Conv")))),i.a.createElement("div",{id:"model-blocker",className:"model-blocker"}),i.a.createElement("div",{className:"model-load"},i.a.createElement("h2",null,"Load Model"),i.a.createElement("label",null,"Model link"),i.a.createElement("input",{type:"text",className:"form-control",placeholder:"Enter model link",onChange:this.onChange}),i.a.createElement("small",{className:"form-text text-muted"},this.state.err),i.a.createElement("br",null),i.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:this.loadModel},"Load")))):null}}]),t}(i.a.Component);a(71);function $(e){if(!e.display)return null;var t=document.createElement("textarea");return document.body.appendChild(t),t.value=e.link,t.select(),document.execCommand("copy"),document.body.removeChild(t),i.a.createElement("div",{onClick:function(t){"linkpage-container"!==t.target.id&&"linkpage-content"!==t.target.id||e.toggle()},className:"linkpage-container",id:"linkpage-container"},i.a.createElement("div",{className:"linkpage-content",id:"linkpage-content"},i.a.createElement("h1",null,"Model Link"),i.a.createElement("input",{readOnly:!0,className:"form-control",type:"text",value:e.link}),i.a.createElement("small",{className:"form-text text-muted"},"Link copied to clipboard")))}a(72);var ee=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(m.a)(t).call(this,e))).props=e,a.state={err:null,name:"",link:"",inputShape:[],outputShape:[],inputShapeDisplay:"",outputShapeDisplay:""},a.onChange=a.onChange.bind(Object(f.a)(Object(f.a)(a))),a.noChange=a.noChange.bind(Object(f.a)(Object(f.a)(a))),a.setError=a.setError.bind(Object(f.a)(Object(f.a)(a))),a.onChangeShapeInput=a.onChangeShapeInput.bind(Object(f.a)(Object(f.a)(a))),a.onChangeShapeOutput=a.onChangeShapeOutput.bind(Object(f.a)(Object(f.a)(a))),a.onChangeName=a.onChangeName.bind(Object(f.a)(Object(f.a)(a))),a.onBlurInput=a.onBlurInput.bind(Object(f.a)(Object(f.a)(a))),a.onBlurOutput=a.onBlurOutput.bind(Object(f.a)(Object(f.a)(a))),a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"setError",value:function(e){this.setState({err:e})}},{key:"onChange",value:function(e){this.setState({link:e.target.value})}},{key:"breakShape",value:function(e){var t=String(e).split(",");if(0===t.length)return[];for(var a=0;a<t.length;a++){var n=parseInt(t[a]);if(isNaN(n))return null;t[a]=n}return t}},{key:"toString",value:function(e){return 0===e.length?"":e.join(",")}},{key:"onChangeShapeInput",value:function(e){this.setState({inputShapeDisplay:e.target.value})}},{key:"onBlurInput",value:function(e){var t=this.breakShape(e.target.value);null!==t?this.setState({inputShape:t,inputShapeDisplay:this.toString(t)}):this.setState({inputShapeDisplay:this.toString(this.state.inputShape)})}},{key:"onChangeShapeOutput",value:function(e){this.setState({outputShapeDisplay:e.target.value})}},{key:"onBlurOutput",value:function(e){var t=this.breakShape(e.target.value);null!==t?this.setState({outputShape:t,outputShapeDisplay:this.toString(t)}):this.setState({outputShapeDisplay:this.toString(this.state.outputShape)})}},{key:"onChangeName",value:function(e){this.setState({name:e.target.value})}},{key:"noChange",value:function(e){"background-input-set"!==e.target.id&&"input-blocker"!==e.target.id||this.props.toggle()}},{key:"render",value:function(){var e=this;return this.props.display?i.a.createElement("div",{id:"background-input-set",onClick:this.noChange,className:"set-input-container"},i.a.createElement("h1",null,"Load Input Dataset"),i.a.createElement("div",{className:"input-container"},i.a.createElement("div",{className:"input-preset"},i.a.createElement("h2",null,"Load Preset"),i.a.createElement("div",{className:"d-flex flex-wrap p-2"},i.a.createElement("div",{className:"p-2"},i.a.createElement("button",{type:"button",onClick:function(){return e.props.loadDefaultInput("MNIST")},className:"btn btn-secondary"},"MNIST")),i.a.createElement("div",{className:"p-2"},i.a.createElement("button",{type:"button",onClick:function(){return e.props.loadDefaultInput("IMDB")},className:"btn btn-secondary"},"IMDB")))),i.a.createElement("div",{id:"input-blocker",className:"input-blocker"}),i.a.createElement("div",{className:"input-load"},i.a.createElement("h2",null,"Load Custom Dataset"),i.a.createElement("div",{className:"form-group"},i.a.createElement("input",{type:"text",className:"form-control",placeholder:"Enter input URL",onChange:this.onChange,value:this.state.link})),i.a.createElement("input",{type:"text",className:"form-control",placeholder:"Name",onChange:this.onChangeName,value:this.state.name}),i.a.createElement("small",{className:"form-text"},"Shape does not include batchSize"),i.a.createElement("div",{className:"form-row"},i.a.createElement("div",{className:"col"},i.a.createElement("input",{type:"text",className:"form-control",placeholder:"Input shape",onChange:this.onChangeShapeInput,onBlur:this.onBlurInput,value:this.state.inputShapeDisplay})),i.a.createElement("div",{className:"col"},i.a.createElement("input",{type:"text",className:"form-control",placeholder:"Output shape",onChange:this.onChangeShapeOutput,onBlur:this.onBlurOutput,value:this.state.outputShapeDisplay}))),i.a.createElement("small",{className:"form-text text-muted"},this.state.err),i.a.createElement("br",null),i.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(){return e.props.loadInput(e.state.link,e.state.name,e.state.inputShape,e.state.outputShape,e.setError)}},"Load")))):null}}]),t}(i.a.Component);function te(e){for(var t={},a={},n=0,r=Object.keys(e);n<r.length;n++){var l=r[n];t[l]=!1,a[l]=!1}for(var i=0,s=Object.keys(e);i<s.length;i++){if(ae(e,s[i],t,a))return!0}return!1}function ae(e,t,a,n){if(a[t])return n[t]=!1,!1;if(a[t]=!0,n[t]=!0,null===e[t].connectedTo)return n[t]=!1,!1;var r=e[t].connectedTo;return!(a[r]||!ae(e,r,a,n))||(!!n[r]||(n[t]=!1,!1))}function ne(e){for(var t={},a=0,n=Object.keys(e);a<n.length;a++){t[n[a]]=0}for(var r=0,l=Object.keys(e);r<l.length;r++){var i=e[l[r]].connectedTo;null!==i&&(t[i]+=1)}if(0!==t[0])return{ok:!1,err:"Input node cannot have incoming edge"};if(null!==e[1].connectedTo)return{ok:!1,err:"Output node cannot have outgoing edge"};for(var s=0,o=Object.keys(e);s<o.length;s++){if(t[o[s]]>1)return{ok:!1,err:"No node can have more than one incoming edge"}}return{ok:!0,err:""}}function re(e){var t=ne(e);if(!t.ok)return t;if(te(e))return{ok:!1,err:"Model cannot be cyclic"};if(null===e[1].shapeIn||2!==e[1].shapeOut.length)return{ok:!1,err:"Output node must have shape (batchSize, categories)"};for(var a=e[0];1!==a.ID;){if(null===a.connectedTo)return{ok:!1,err:"Model does not connect from input node to output node"};a=e[a.connectedTo]}return{ok:!0,err:""}}function le(e){return fetch(Y+"Architecture",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:e}).then(function(e){if(201===e.status)return e.json();throw new Error("Something went wrong")})}a(73);function ie(e){var t=e.selected===e.name?"btn btn-info":"btn btn-secondary";return i.a.createElement("div",{className:"p-2"},i.a.createElement("button",{type:"button",onClick:function(){return e.select(e.name)},className:t},e.displayName))}var se=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(m.a)(t).call(this,e))).props=e,a.onClick=a.onClick.bind(Object(f.a)(Object(f.a)(a))),a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"onClick",value:function(e){"background-input-set"===e.target.id&&this.props.toggle()}},{key:"render",value:function(){var e=this;return this.props.display?i.a.createElement("div",{id:"background-input-set",className:"set-input-container",onClick:this.onClick},i.a.createElement("h1",null,"Setup Training Details"),i.a.createElement("div",{className:"input-container"},i.a.createElement("div",{className:"input-preset"},i.a.createElement("h2",null,"Optimizer"),i.a.createElement("div",null,"Learning Rate: ",i.a.createElement("input",{id:"learning-rate",type:"number",step:"any",value:this.props.modelInfo.learningRate,onChange:function(){return e.props.update("learningRate",parseFloat(document.getElementById("learning-rate").value))},min:"0"})),i.a.createElement("div",{className:"d-flex flex-wrap p-2"},i.a.createElement(ie,{name:"adam",displayName:"Adam",selected:this.props.modelInfo.optimizer,select:function(t){return e.props.update("optimizer",t)}}),i.a.createElement(ie,{name:"sgd",displayName:"SGD",selected:this.props.modelInfo.optimizer,select:function(t){return e.props.update("optimizer",t)}}),i.a.createElement(ie,{name:"rmsProp",displayName:"RMS Prop",selected:this.props.modelInfo.optimizer,select:function(t){return e.props.update("optimizer",t)}}))),i.a.createElement("div",{id:"input-blocker",className:"input-blocker"}),i.a.createElement("div",{className:"input-load"},i.a.createElement("h2",null,"Loss"),i.a.createElement("div",{className:"d-flex flex-wrap p-2"},i.a.createElement(ie,{name:"mse",displayName:"Mean Squared Error",selected:this.props.modelInfo.loss,select:function(t){return e.props.update("loss",t)}}),i.a.createElement(ie,{name:"logcosh",displayName:"Log Cosh",selected:this.props.modelInfo.loss,select:function(t){return e.props.update("loss",t)}}),i.a.createElement(ie,{name:"cce",displayName:"Categorical Crossentropy",selected:this.props.modelInfo.loss,select:function(t){return e.props.update("loss",t)}}))))):null}}]),t}(i.a.Component),oe=a(54),ce=a.n(oe),ue=(a(144),function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(m.a)(t).call(this,e))).state={models:{0:a._model("input",0,20,50),1:a._model("output",1,300,50)},modelInfo:{epochs:"2",batchSize:"25",maxToken:null,loss:"cce",optimizer:"adam",learningRate:"0.01"},selected:0,nextID:2,errorMsg:null,errorOnce:!1,trainingInfo:{accuracy:null,testAccuracy:null,loss:null,progress:null,training:!1},modelID:null,sessionID:null,intervalID:null,editableSelected:!1,selectModelPage:!0,linkPage:!1,link:null,settingInput:!1,trainSetup:!1},a.newModel=a.newModel.bind(Object(f.a)(Object(f.a)(a))),a.updateModel=a.updateModel.bind(Object(f.a)(Object(f.a)(a))),a.selectModel=a.selectModel.bind(Object(f.a)(Object(f.a)(a))),a.removeModel=a.removeModel.bind(Object(f.a)(Object(f.a)(a))),a.setEditableSelected=a.setEditableSelected.bind(Object(f.a)(Object(f.a)(a))),a.updateModelInfo=a.updateModelInfo.bind(Object(f.a)(Object(f.a)(a))),a.setError=a.setError.bind(Object(f.a)(Object(f.a)(a))),a.trainCloud=a.trainCloud.bind(Object(f.a)(Object(f.a)(a))),a.startSession=a.startSession.bind(Object(f.a)(Object(f.a)(a))),a.updateTrain=a.updateTrain.bind(Object(f.a)(Object(f.a)(a))),a.cancelTrain=a.cancelTrain.bind(Object(f.a)(Object(f.a)(a))),a.state.models=a._updateDependents(a.state.models),a.loadDefaultModel=a.loadDefaultModel.bind(Object(f.a)(Object(f.a)(a))),a.loadModel=a.loadModel.bind(Object(f.a)(Object(f.a)(a))),a.downloadModel=a.downloadModel.bind(Object(f.a)(Object(f.a)(a))),a.getLink=a.getLink.bind(Object(f.a)(Object(f.a)(a))),a.setInput=a.setInput.bind(Object(f.a)(Object(f.a)(a))),a.loadDefaultInput=a.loadDefaultInput.bind(Object(f.a)(Object(f.a)(a))),a.loadCustomInput=a.loadCustomInput.bind(Object(f.a)(Object(f.a)(a))),a.trainSetup=a.trainSetup.bind(Object(f.a)(Object(f.a)(a))),a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"_model",value:function(e,t,a,n){return{name:e+String(t),ID:t,type:e,x:a,y:n,connectedTo:null,shapeIn:null,shapeOut:null,activation:null,parameters:ce()(k[e].defaultParameters)}}},{key:"model",value:function(e){return this._model(e,this.state.nextID,10+80*Math.random(),10+80*Math.random())}},{key:"updateDependents",value:function(e){return this.setError(null,!1),this._updateDependents(e)}},{key:"_updateDependents",value:function(e){var t=e[0];t.shapeOut=k[t.type].shapeOut(t.parameters,this.state.modelInfo,this.setError),t.shapeIn=t.shapeOut;for(var a=t,n=e[t.connectedTo];null!==a.connectedTo;)n.shapeIn=a.shapeOut,"input"===n.type?n.shapeOut=k[n.type].shapeOut(n.parameters,this.state.modelInfo,this.setError):n.shapeOut=k[n.type].shapeOut(n.parameters,n.shapeIn,this.setError),a=n,n=e[n.connectedTo];return e}},{key:"newModel",value:function(e){var t=Object(c.a)({},this.state.models),a=Object(c.a)({},t,Object(o.a)({},this.state.nextID,this.model(e)));a=this.updateDependents(a),this.setState({models:a,nextID:this.state.nextID+1})}},{key:"selectModel",value:function(e){this.setState({selected:e})}},{key:"updateModel",value:function(e,t){for(var a=Object(c.a)({},this.state.models),n=0,r=Object.keys(t);n<r.length;n++){var l=r[n];a[e][l]=t[l]}te(a)?this.setError("Graph cannot have loops",!1):ne(a).ok?(this.setError(null,!1),a=this.updateDependents(a),this.setState({models:a})):this.setError(ne(a).err,!1)}},{key:"removeModel",value:function(e){for(var t={},a=0,n=Object.keys(this.state.models);a<n.length;a++){var r=n[a];this.state.models[r].ID!==e&&(t[r]=this.state.models[r])}for(var l=0,i=Object.keys(t);l<i.length;l++){var s=i[l];t[s].connectedTo===e&&(t[s].connectedTo=null)}t=this.updateDependents(t),this.setState({models:t})}},{key:"updateParameters",value:function(e,t,a,n){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=Object(c.a)({},this.state.models[e]),i=String(a).split(",");if(0!==i.length){for(var s=0;s<i.length;s++){var o=r?parseFloat(i[s]):parseInt(i[s]);if(isNaN(o))return;i[s]=o}if(i.length>1){if(!n)return;l.parameters[t]=i}else l.parameters[t]=i[0];var u=Object(c.a)({},this.state.models);u[e]=l,u=this.updateDependents(u),this.setState({models:u})}}},{key:"updateModelInfo",value:function(e,t){if(!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])||!isNaN(t)&&""!==t){var a=this.state.modelInfo;a[e]=t,this.setState({modelInfo:a})}}},{key:"setError",value:function(e,t){if(t)this.setState({errorMsg:e,errorOnce:t});else{if(this.state.errorOnce&&null!==this.state.errorMsg)return;this.setState({errorMsg:e,errorOnce:t})}}},{key:"setEditableSelected",value:function(e){this.setState({editableSelected:e})}},{key:"trainCloud",value:function(){var e=this,t=this.updateDependents(this.state.models);this.setState({models:t});var a=re(t);a.ok?le(JSON.stringify({modelJSON:JSON.stringify({model:t,modelInfo:this.state.modelInfo})})).then(function(t){var a=e.state.trainingInfo;a.training=!0,e.setState({trainingInfo:a,modelID:t.data.id}),e.selectModel(-1),e.startSession(t.data.id)}).catch(function(t){e.setError(t.message,!0)}):this.setError(a.err,!0)}},{key:"startSession",value:function(e){var t=this;(function(e){return fetch(Y+"Train",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e})}).then(function(e){if(201===e.status)return e.json();throw new Error("Internal error")})})(e).then(function(e){var a=e.data,n=setInterval(t.updateTrain,100);t.setState({sessionID:a.sessionID,intervalID:n})}).catch(function(e){t.setError(e.message,!0)})}},{key:"updateTrain",value:function(){var e,t=this;(e=this.state.sessionID,fetch(Y+"Train?id="+e).then(function(e){if(200===e.status)return e.json();throw new Error("Training session failed to be fetched")})).then(function(e){var a={accuracy:String(Math.floor(100*e.accuracy))+"%",testAccuracy:String(Math.floor(100*e.test_accuracy))+"%",loss:Number(parseFloat(e.loss).toFixed(3)),progress:String(Math.floor(100*e.progress))+"%",training:!e.trained};t.setState({trainingInfo:a}),e.trained&&clearInterval(t.state.intervalID)}).catch(function(e){t.setError(e.message,!0),t.cancelTrain()})}},{key:"cancelTrain",value:function(){clearInterval(this.state.intervalID);var e,t=this.state.trainingInfo;t.training=!1,this.setState({trainingInfo:t}),e=this.state.sessionID,fetch(Y+"Train",{method:"DELETE",body:JSON.stringify({id:e})})}},{key:"loadModel",value:function(e,t){var a=this;(function(e){return fetch(Y+"Link?link="+e).then(function(e){if(200===e.status||404===e.status||400===e.status)return e.json();throw new Error("Something went wrong with retrieving ID from link")}).then(function(e){if("message"in e)throw new Error(e.message);return e.id})})(e).then(function(e){(function(e){return fetch(Y+"Architecture?id="+e).then(function(e){if(200===e.status||404===e.status||400===e.status)return e.json();throw new Error("Something went wrong when getting model")}).then(function(e){if("message"in e)throw new Error(e.message);return e.data.modelJSON})})(e).then(function(e){var n=JSON.parse(e),r=a.state.modelInfo;a.setState({modelInfo:r,models:n.model,nextID:Math.max.apply(Math,Object(s.a)(Object.keys(n.model).map(function(e){return Number(e)})))+1,selectModelPage:!1}),t(null)}).catch(function(e){t(e.message)})}).catch(function(e){t(e.message)})}},{key:"loadDefaultModel",value:function(e){var t=null;switch(e){case"blank":t=N;break;case"dense":t=I;break;case"conv":t=j;break;default:return}this.setState({nextID:Math.max.apply(Math,Object(s.a)(Object.keys(t).map(function(e){return Number(e)})))+1,models:t.model,modelInfo:t.info,selectModelPage:!1})}},{key:"getLink",value:function(){var e=this,t=this.updateDependents(this.state.models);this.setState({models:t}),le(JSON.stringify({modelJSON:JSON.stringify({model:t,modelInfo:this.state.modelInfo})})).then(function(t){var a;(a=t.data.id,fetch(Y+"Link",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({modelID:a})}).then(function(e){if(201===e.status)return e.json();throw new Error("Failed to generate link")})).then(function(t){var a=t.data.link;e.setState({link:a,linkPage:!0})}).catch(function(t){e.setError(t.message,!0)})}).catch(function(t){e.setError(t.message,!0)})}},{key:"downloadModel",value:function(){var e=this,t=this.updateDependents(this.state.models);this.setState({models:t});var a=re(t);a.ok?le(JSON.stringify({modelJSON:JSON.stringify({model:t,modelInfo:this.state.modelInfo})})).then(function(t){(function(e){return fetch(Y+"Download?id="+e).then(function(e){if(200===e.status||404===e.status||400===e.status)return e.json();throw new Error("Something went wrong with downloading the model")}).then(function(e){if("message"in e)throw new Error(e.message);return e.data})})(t.data.id).then(function(e){var t=document.createElement("a"),a=new Blob([e],{type:"text/json"});t.href=URL.createObjectURL(a),t.download="model_architecture.json",t.click()}).catch(function(t){e.setError(t.message,!0)})}).catch(function(t){e.setError(t.message,!0)}):this.setError(a.err,!0)}},{key:"loadDefaultInput",value:function(e){var t=this.state.models;t[0].parameters.data=e,t[0].parameters.inputShape=X[e].input,t[1].parameters.outputShape=X[e].output;var a=this.state.modelInfo;"IMDB"===e&&(a.maxToken=1e3),this.setState({models:this.updateDependents(t),settingInput:!1,modelInfo:a})}},{key:"loadCustomInput",value:function(e,t,a,n,r){var l=this;0!==a.length&&0!==n.length?null!==t?function(e,t,a,n){return fetch(Y+"Dataset",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({link:e,datasetName:t,inputShape:String(a),outputShape:String(n)})}).then(function(e){if(201===e.status||404===e.status||400===e.status)return e.json();throw new Error("Something went wrong when loading the input")}).then(function(e){if(console.log(e),"message"in e)throw new Error(e.message);return e.data})}(e,t,a,n).catch(function(e){r(e.message)}).then(function(e){var t=l.state.models;t[0].parameters.data=e.datasetName,t[0].parameters.inputShape=JSON.parse(e.inputShape),t[0].parameters.datasetID=e.datasetID,t[1].parameters.data=e.datasetName,t[1].parameters.outputShape=JSON.parse(e.outputShape),t=l.updateDependents(t),l.setState({models:t,settingInput:!1}),console.log(t)}):r("Name your dataset!"):r("Input and output shapes must be set")}},{key:"setInput",value:function(){this.setState({settingInput:!0})}},{key:"trainSetup",value:function(){this.setState({trainSetup:!0})}},{key:"render",value:function(){var e=this;return i.a.createElement(i.a.Fragment,null,i.a.createElement($,{display:this.state.linkPage,link:this.state.link,toggle:function(){return e.setState({linkPage:!1})}}),i.a.createElement(Z,{display:this.state.selectModelPage,loadModel:this.loadModel,loadDefaultModel:this.loadDefaultModel,toggle:function(){return e.setState({selectModelPage:!1})}}),i.a.createElement(ee,{display:this.state.settingInput,loadDefaultInput:this.loadDefaultInput,loadInput:this.loadCustomInput,toggle:function(){e.setState({settingInput:!1})}}),i.a.createElement(se,{display:this.state.trainSetup,toggle:function(){return e.setState({trainSetup:!1})},modelInfo:this.state.modelInfo,update:this.updateModelInfo}),i.a.createElement(Q,{errorMsg:this.state.errorMsg,dismissible:this.state.errorOnce,setError:this.setError}),i.a.createElement("div",{className:"container-fluid d-flex h-100 flex-row no-margin"},i.a.createElement(P,{models:this.state.models,selected:this.state.selected,trainingInfo:this.state.trainingInfo,newModel:this.newModel,setError:this.setError,update:this.updateModel,setSelectModelPage:function(){return e.setState({selectModelPage:!0})},trainCloud:this.trainCloud,cancelTrain:this.cancelTrain,getLink:this.getLink,downloadModel:this.downloadModel,setInput:this.setInput}),i.a.createElement("div",{className:"d-flex w-100 p-2 flex-column flex-grow-1 no-margin",ref:"canvasContainer"},i.a.createElement(W,{models:this.state.models,selected:this.state.selected,select:this.selectModel,update:this.updateModel,remove:this.removeModel,editableSelected:this.state.editableSelected}),i.a.createElement(K,{trainSetup:this.trainSetup,modelInfo:this.state.modelInfo,setInputDataset:this.setInput,trainingInfo:this.state.trainingInfo,updateModelInfo:this.updateModelInfo,selected:this.state.selected,models:this.state.models,update:function(t,a,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return e.updateParameters(e.state.selected,t,a,n,r)},setEditableSelected:this.setEditableSelected}))))}}]),t}(i.a.Component));a(145),a(146);r.a.render(i.a.createElement(ue,null),document.getElementById("root"))},55:function(e,t,a){e.exports=a(147)},63:function(e,t,a){},67:function(e,t,a){},68:function(e,t,a){},69:function(e,t,a){},70:function(e,t,a){},71:function(e,t,a){},72:function(e,t,a){},73:function(e,t,a){}},[[55,1,2]]]);
//# sourceMappingURL=main.5bc7b24c.chunk.js.map