{"version":3,"sources":["ModelInfo.js","Sidebar.js","Group.js","Line.js","Constants.js","Canvas.js","Toolbar.js","ErrorBox.js","SelectModel.js","LinkPage.js","SetInput.js","Utils.js","Server.js","TrainSetup.js","App.js","index.js"],"names":["activationBoxHeight","activationBoxColor","nodeTypes","dense","name","type","svg","props","activationSVG","circles","Object","toConsumableArray","Array","map","_","i","react_default","a","createElement","cx","xSize","cy","key","r","fill","activation","Fragment","width","height","y","offsetX","offsetY","defaultParameters","units","canActivation","shapeOut","parameters","shapeIn","setError","concat","slice","length","conv","xInterval","yInterval","x","squareSize","filters","kernelSize","stride","batchSize","dimensions","kernel","isArray","mapped","dimension","Math","floor","input","data","datasetID","inputShape","modelInfo","Number","maxpool","poolSize","embedding","isNumber","dropout","color","len","rate","flatten","reduce","total","value","output","outputShape","relu","d","stroke","strokeWidth","sigmoid","tanh","softmax","layerNames","activationNames","blankModel","JSON","parse","convModel","denseModel","SidebarHeader","className","tabSelected","onClick","changeTab","CTAList","href","Button","disabled","children","Layer","newModel","Activation","newActivation","EditElements","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","propsOri","setActivation","bind","assertThisInitialized","selected","models","update","_this2","Collapsible_default","trigger","triggerTagName","id","triggerClassName","triggerOpenedClassName","onOpen","onClose","open","layersCollapsed","activationsCollapsed","React","Component","TrainElements","propOri","isTraining","trainingInfo","trainButton","cancelTrain","trainCloud","setSelectModelPage","getLink","downloadModel","setInput","ElementsContainer","propsExtracted","Elements","Sidebar_EditElements","Sidebar","_React$Component2","_this3","state","set","inherits","createClass","v","setState","tab","Group","_React$Component","onMouseDown","e","model","handleDrag","clientX","clientY","ID","transform","String","style","userSelect","MarkerDefs","viewBox","refX","refY","markerWidth","markerHeight","orient","Line","strokeDasharray","tentative","pointerEvents","midX","x1","x2","midY","y1","y2","markerStart","markerMid","markerEnd","BASE_URL","DATASET_SHAPE","MNIST","IMDB","modelCenter","Canvas","isNewline","xOffset","yOffset","selectedLineFromTo","dragging","initX","initY","initModelX","initModelY","handleElementClick","trackMouse","handleBGClick","handleLineClick","deleteSelection","onMouseUp","dim","ReactDOM","findDOMNode","getBoundingClientRect","document","addEventListener","removeEventListener","editableSelected","keyCode","cancelNewline","select","remove","from","to","connectedTo","newX","newY","dragged","abs","target","refs","canvas","startNewline","idFrom","idTo","modelElements","entries","_ref","_ref2","slicedToArray","Group_Group","tentativeLine","coords","lines","_ref3","_ref4","index","otherModel","otherCoords","onMouseMove","ref","Padding","CanvasContainer","Canvas_Canvas","DisplayLine","EditableLine","valueChanged","currentValue","onFocus","setEditableSelected","onChange","onBlur","callback","paraName","event","oldValue","DataInput","setInputDataset","Parameters","Toolbar_EditableLine","n","Toolbar","loss","accuracy","testAccuracy","progress","updateModelInfo","trainSetup","training","incomingShape","outgoingShape","ErrorBox","errorMsg","dismissible","data-dismiss","aria-label","aria-hidden","SelectModel","err","link","noChange","loadModel","toggle","display","loadDefaultModel","placeholder","LinkPage","dummy","body","appendChild","execCommand","removeChild","readOnly","SetInput","inputShapeDisplay","outputShapeDisplay","onChangeShapeInput","onChangeShapeOutput","onChangeName","onBlurInput","onBlurOutput","components","split","num","parseInt","isNaN","shape","join","breakShape","toString","loadDefaultInput","loadInput","isCyclic","visited","inRecursionStack","_i","_Object$keys","keys","_i2","_Object$keys2","isCyclicHelper","next","isLinear","numIncomingEdges","_i3","_Object$keys3","_i4","_Object$keys4","ok","_i5","_Object$keys5","isTrainable","resp","currentNode","saveModel","serializedModel","fetch","method","headers","Accept","Content-Type","then","response","status","json","Error","Option","displayName","TrainSetup","step","learningRate","parseFloat","getElementById","min","optimizer","App","0","_model","1","epochs","maxToken","nextID","errorOnce","modelID","sessionID","intervalID","selectModelPage","linkPage","settingInput","updateModel","selectModel","removeModel","startSession","updateTrain","_updateDependents","loadCustomInput","cloneDeep","random","inputNode","nextNode","oldModels","objectSpread","newModels","defineProperty","updateDependents","dict","canTuple","floatOkay","arguments","undefined","once","t","stringify","modelJSON","responseJSON","info","catch","message","setInterval","_this4","toFixed","clearInterval","_this5","getIDFromLink","getModel","decoded","max","apply","_this6","_this7","element","file","Blob","URL","createObjectURL","download","click","url","_this8","datasetName","console","log","_this9","LinkPage_LinkPage","SelectModel_SelectModel","SetInput_SetInput","TrainSetup_TrainSetup","ErrorBox_ErrorBox","Sidebar_Sidebar","Toolbar_Toolbar","updateParameters","render","src_App_0"],"mappings":"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","file":"static/js/main.58d9c103.chunk.js","sourcesContent":["import React from 'react';\nimport { isArray, isNumber } from 'util';\n\n// mega fuckton of constants to describe the svg\n// shapes of things\n\n\n// describe layers' and activation function's svg representation\nconst activationBoxHeight = 20;\nconst activationBoxColor = \"#cccccc\";\n\nfunction conv(props) {\n  // svg for a conv layer\n  const squareSize = 40;\n  const xInterval = squareSize / 4;\n  const yInterval = squareSize / 4;\n\n  const firstColor = \"#2775f4\";\n  const secondColor = \"#4286f4\";\n  const thirdColor = \"#5c98f9\";\n  let activationSVG;\n  if (props.activation != null) {\n    activationSVG = nodeTypes[props.activation].svg(xInterval*2+squareSize/2, yInterval*2+squareSize+activationBoxHeight/2+3);\n  } else {\n    activationSVG = null\n  }\n  return <React.Fragment>\n    <rect width={squareSize} height={squareSize} fill={firstColor}/>\n    <rect x={xInterval} y={yInterval} width={squareSize} height={squareSize} fill={secondColor}/>\n    <rect x={xInterval*2} y={yInterval*2} width={squareSize} height={squareSize} fill={thirdColor}/>\n    <rect x={xInterval*2} y={yInterval*2+squareSize} width={squareSize} height={activationBoxHeight} fill={activationBoxColor}/>\n    {activationSVG}\n  </React.Fragment>\n}\n\nfunction dense(props) {\n  // svg for a dense layer\n  const xSize = 40;\n  const ySize = 80;\n  const numCircles = 3;\n  const squareColor = \"#665cf9\";\n  \n  const circleColor = \"#83a5f7\";\n\n  const circles = [...Array(numCircles)].map((_, i) =>\n    <circle cx={xSize / 2} \n            cy={(ySize-8) / numCircles * (i+0.5)+4} \n            key={i}\n            r={ySize / numCircles / 2 - 4}\n            fill={circleColor}>\n            \n            </circle>\n  );\n  let activationSVG;\n  if (props.activation != null) {\n    activationSVG = nodeTypes[props.activation].svg(xSize/2, ySize+activationBoxHeight/2+3);\n  } else {\n    activationSVG = null\n  }\n  return <React.Fragment>\n    <rect width={xSize} height={ySize} fill={squareColor}/>\n    <rect width={xSize} y={ySize} height={activationBoxHeight} fill={activationBoxColor}/>\n    {circles}\n    {activationSVG}\n  </React.Fragment>\n}\n\nfunction input(props) {\n  // svg for an input layer\n  const size = 30\n  const color = \"#99ccff\";\n  return <React.Fragment>\n    <rect width={size} height={size} fill={color}/>\n  </React.Fragment>\n}\n\nfunction output(props) {\n  // svg for an output layer\n  const color = \"#008066\";\n  const width = 30;\n  const height = 60;\n\n  let activationSVG;\n  if (props.activation != null) {\n    activationSVG = nodeTypes[props.activation].svg(width/2, height+activationBoxHeight/2+3);\n  } else {\n    activationSVG = null\n  }\n\n  return <React.Fragment>\n    <rect width={width} height={height} fill={color}></rect>\n    <rect width={width} y={height} height={activationBoxHeight} fill={activationBoxColor}></rect>\n    {activationSVG}\n  </React.Fragment>\n}\n\nfunction maxpool(props) {\n  // svg for a maxpool layer\n  const squareSize = 30;\n  const xInterval = squareSize / 4;\n  const yInterval = squareSize / 4;\n\n  const firstColor = \"#be41f4\";\n  const secondColor = \"#e541f4\";\n  const thirdColor = \"#f95cf9\";\n\n  return <React.Fragment>\n    <rect width={squareSize} height={squareSize} fill={firstColor}/>\n    <rect x={xInterval} y={yInterval} width={squareSize} height={squareSize} fill={secondColor}/>\n    <rect x={xInterval*2} y={yInterval*2} width={squareSize} height={squareSize} fill={thirdColor}/>\n  </React.Fragment>\n}\n\nfunction embedding(props) {\n  // svg for an embedding layer\n  const width = 20;\n  const height = 15;\n  const firstColor = \"#6a41f4\";\n  const secondColor = \"#8a61ff\";\n  const thirdColor = \"#7a51f5\";\n  return <React.Fragment>\n    <rect width={width*3} height={height} fill={firstColor}></rect>\n    <rect width={width*1.5} height={height} y={height} fill={secondColor}></rect>\n    <rect width={width*2.5} height={height} y={height*2} fill={thirdColor}></rect>\n  </React.Fragment>\n}\n\nfunction dropout(props) {\n  // svg for a dropout layer\n  const len = 10;\n  const color = \"#404040\";\n  return <React.Fragment>\n    <rect width={len} height={len} x={len*0} y={len*0} fill={color}></rect>\n    <rect width={len} height={len} x={len*2} y={len*0} fill={color}></rect>\n    <rect width={len} height={len} x={len*3} y={len*0} fill={color}></rect>\n    <rect width={len} height={len} x={len*1} y={len*1} fill={color}></rect>\n    <rect width={len} height={len} x={len*2} y={len*1} fill={color}></rect>\n    <rect width={len} height={len} x={len*0} y={len*2} fill={color}></rect>\n    <rect width={len} height={len} x={len*2} y={len*2} fill={color}></rect>\n    <rect width={len} height={len} x={len*3} y={len*2} fill={color}></rect>\n    <rect width={len} height={len} x={len*1} y={len*3} fill={color}></rect>\n    <rect width={len} height={len} x={len*2} y={len*3} fill={color}></rect>\n    <rect width={len} height={len} x={len*3} y={len*3} fill={color}></rect>\n  </React.Fragment>\n}\n\nfunction flatten(props) {\n  // svg for a flatten layer\n  const width = 16;\n  const height = 120;\n  const color = \"#404040\";\n  return <React.Fragment>\n    <rect width={width} height={height} fill={color}></rect>\n  </React.Fragment>\n}\n\nfunction relu(x, y) {\n  // svg for a relu function\n  const width = 12;\n  const height = 8;\n  return <React.Fragment>\n    <path d={\"M\"+(x-width)+\" \"+y+\"l\"+width+ \" 0 l\" + width + \" -\" + height} stroke=\"black\" strokeWidth=\"2\" fill=\"none\"/>\n  </React.Fragment>\n}\n\nfunction sigmoid(x, y) {\n  // svg for a sigmoid function\n  const width = 12;\n  const height = 4;\n  return (\n    <path d={\"M \"+(x-width)+\" \"+y+\" q \"+(width-1)+ \" 0 \" + width + \" \" + (-height) + \" q 1 \" + (-height) + \" \" + width + \" \" + (-height)} stroke=\"black\" strokeWidth=\"2\" fill=\"none\"/>\n  )\n}\n\nfunction softmax(x, y) {\n  // svg for a softmax function\n  const width = 24;\n  const height = 8;\n  return (\n    <path d={\"M \"+(x-width/2)+\" \"+y+\" q \"+(width-1)+ \" 0 \" + width + \" \" + (-height)} stroke=\"black\" strokeWidth=\"2\" fill=\"none\"/>\n  )\n}\n\nfunction tanh(x, y) {\n  // svg for a tanh function\n  const width = 12;\n  const height = 4;\n  return (\n    <path d={\"M \"+(x-width)+\" \"+y+\" q \"+(width-5)+ \" 0 \" + width + \" \" + (-height) + \" q 5 \" + (-height) + \" \" + width + \" \" + (-height)} stroke=\"black\" strokeWidth=\"2\" fill=\"none\"/>\n  )\n}\n\n// this is a mapping from node type (layer or activation)\n// to its relevant constant information\n\n// name is its display name\n// type can be layer or activation\n// svg is its corresponding svg to be rendered\n// defaultParameters include its default parameters\n// canActivation indicates whether a layer can have an activation function\n// shapeOut is a functio nto calculate its output shape given its parameter and input shape\n\n// offsetX and offsetY for finding the center of the svg (from its corner)\n\nexport const nodeTypes = {\n    \"dense\": {\n        name: \"Dense\",\n        type: \"layer\",\n        svg: dense,\n        offsetX: 20, // offsets are for giving a point of contact for lines\n        offsetY: 50, \n        defaultParameters: {\n          units: 16,\n        },\n        canActivation: true,\n        // the function to compute the output shape given input shape and parameters\n        shapeOut: (parameters, shapeIn, setError) => {\n          if (shapeIn === null) {\n            return null;\n          }\n          return [...shapeIn.slice(0,shapeIn.length-1), parameters[\"units\"]];\n        },\n    },\n    \"conv\": {\n        name: \"Conv\",\n        type: \"layer\",\n        svg: conv,\n        offsetX: 40,\n        offsetY: 40,\n        defaultParameters: {\n          filters: 8,\n          kernelSize: [3,3], // could be both tuple or int. ndim needs to match with stride\n          stride: 1, // could be both tuple or int\n        },\n        canActivation: true,\n        shapeOut: (parameters, shapeIn, setError) => {\n          if (shapeIn === null) {\n            return null;\n          }\n          const batchSize = shapeIn[0];\n          const dimensions = shapeIn.slice(1, shapeIn.length-1);\n          const kernel = isArray(parameters[\"kernelSize\"]) ? parameters[\"kernelSize\"] : [parameters[\"kernelSize\"]];\n          \n          const stride = (typeof(parameters[\"stride\"]) === \"number\") ? Array(kernel.length).fill(parameters['stride']) : parameters[\"stride\"];\n          const filters = parameters[\"filters\"];\n          if (dimensions.length !== kernel.length) {\n            setError(\"Kernel must have the same ndim as the input dimension (without batchSize)\", false);\n            return null;\n          }\n          const mapped = dimensions.map((dimension, key) => {\n            return Math.floor((dimension - kernel[key])/stride[key])+1;\n          });\n          return [batchSize, ...mapped, filters];\n        },\n    },\n    \"input\": {\n      name: \"Input\",\n      type: \"layer\",\n      svg: input,\n      offsetX: 15,\n      offsetY: 15,\n      defaultParameters: {\n        data: \"MNIST\",\n        datasetID: \"\",\n        inputShape: [28, 28, 1],\n      },\n      canActivation: false,\n      shapeOut: (parameters, modelInfo, setError) => {\n        if (parameters['inputShape'] === null) {\n          return null;\n        }\n        if (isArray(parameters['inputShape'])) {\n          return [Number(modelInfo[\"batchSize\"]), ...parameters['inputShape']];\n        }\n        return [Number(modelInfo[\"batchSize\"]), parameters['inputShape']];\n      },\n    },\n    \"maxpool\": {\n      name: \"Max Pool\",\n      type: \"layer\",\n      svg: maxpool,\n      offsetX: 30,\n      offsetY: 30,\n      defaultParameters: {\n        poolSize: [2,2], // the length is dimensionality; can be between 1 to 3\n      },\n      canActivation: false,\n      shapeOut: (parameters, shapeIn, setError) => {\n        if (shapeIn === null) {\n          return null;\n        }\n        const batchSize = shapeIn[0];\n        const dimensions = shapeIn.slice(1,shapeIn.length-1);\n        const filters = shapeIn[shapeIn.length-1];\n        const poolSize = (typeof(parameters[\"poolSize\"]) === \"number\") ? [parameters[\"poolSize\"]] : parameters[\"poolSize\"];\n        \n        if (dimensions.length !== poolSize.length) {\n          setError(\"PoolSize must have the same ndim as the input dimension (without batchSize)\", false);\n          return null;\n        }\n        const mapped = dimensions.map((dimension, key) => {\n          return Math.floor((dimension)/poolSize[key]);\n        });\n        return [batchSize, ...mapped, filters];\n      }\n    },\n    \"embedding\": {\n      name: \"Embedding\",\n      type: \"layer\",\n      svg: embedding,\n      offsetX: 25,\n      offsetY: 20,\n      defaultParameters: {\n        units: 100,\n      },\n      canActivation: false,\n      shapeOut: (parameters, shapeIn, setError) => {\n        if (shapeIn === null) {\n          return null;\n        }\n        if (isNumber(shapeIn) || shapeIn.length !== 2) {\n          setError(\"Embedding input shape must be (batchSize, sequenceLength)\", false);\n          return null;\n        }\n        return [shapeIn[0], shapeIn[1], parameters['units']];\n      },\n    },\n    \"dropout\": {\n      name: \"Dropout\",\n      type: \"layer\",\n      svg: dropout,\n      offsetX: 20,\n      offsetY: 20,\n      defaultParameters: {\n        rate: 0.25,\n      },\n      canActivation: false,\n      shapeOut: (parameters, shapeIn, setError) => {\n        if (shapeIn === null) {\n          return null;\n        }\n        return shapeIn;\n      }\n    },\n    \"flatten\": {\n      name: \"Flatten\",\n      type: \"layer\",\n      svg: flatten,\n      offsetX: 8,\n      offsetY: 60,\n      defaultParameters: {},\n      canActivation: false,\n      shapeOut: (parameters, shapeIn, setError) => {\n        if (shapeIn === null) {\n          return null;\n        }\n        if (isNumber(shapeIn) || shapeIn.length <= 2) {\n          setError(\"Flatten input shape must be (batchSize, ...shape) (ndim > 2)\", false);\n          return null;\n        }\n        return [shapeIn[0], shapeIn.slice(1).reduce((total, value) => total*value)];\n      }\n    },\n    \"output\": {\n      name: \"Output\",\n      type: \"layer\",\n      svg: output,\n      offsetX: 10,\n      offsetY: 40,\n      defaultParameters: {\n        data: \"MNIST\",\n        outputShape: [10],\n      },\n      canActivation: true,\n      shapeOut: (parameters, shapeIn, setError) => {\n        if (shapeIn === null) {\n          return null;\n        }\n        if (isNumber(shapeIn) || shapeIn.length !== 2) {\n          setError(\"Output layer must have input layer of shape (batchSize, dim)\", false);\n        }\n        if (isArray(parameters['outputShape'])) {\n          return [...shapeIn.slice(0,shapeIn.length-1), ...parameters['outputShape']];\n        } else {\n          return [...shapeIn.slice(0,shapeIn.length-1), parameters['outputShape']];\n        }\n        \n      },\n    },\n    \"relu\": {\n      name: \"ReLU\",\n      type: \"activation\",\n      svg: relu,\n      defaultParameters: {}\n    },\n    \"sigmoid\": {\n      name: \"Sigmoid\",\n      type: \"activation\",\n      svg: sigmoid,\n      defaultParameters: {}\n    },\n    \"tanh\": {\n      name: \"Tanh\",\n      type: \"activation\",\n      svg: tanh,\n      defaultParameters: {}\n    },\n    \"softmax\": {\n      name: \"SoftMax\",\n      type: \"activation\",\n      svg: softmax,\n      defaultParameters: {}\n    }\n};\n\n// some more constants\nexport const layerNames = [\"dense\", \"conv\", \"maxpool\", \"flatten\", \"embedding\", \"dropout\"];\nexport const activationNames = [\"relu\", \"sigmoid\", \"softmax\", \"tanh\"];\n\n// preset models\n\nexport const blankModel = JSON.parse('{\"model\":{\"0\":{\"name\":\"input0\",\"ID\":0,\"type\":\"input\",\"x\":20,\"y\":50,\"connectedTo\":null,\"shapeIn\":[25,28,28,1],\"shapeOut\":[25,28,28,1],\"activation\":null,\"parameters\":{\"data\":\"MNIST\",\"datasetID\":\"\",\"inputShape\":[28,28,1]}},\"1\":{\"name\":\"output1\",\"ID\":1,\"type\":\"output\",\"x\":300,\"y\":50,\"connectedTo\":null,\"shapeIn\":null,\"shapeOut\":null,\"activation\":null,\"parameters\":{\"data\":\"MNIST\",\"outputShape\":[10]}}},\"modelInfo\":{\"epochs\":\"2\",\"batchSize\":\"25\",\"maxToken\":null,\"loss\":\"cce\",\"optimizer\":\"adam\",\"learningRate\":\"0.01\"}}');\n\nexport const convModel = JSON.parse('{\"model\":{\"0\":{\"name\":\"input0\",\"ID\":0,\"type\":\"input\",\"x\":20,\"y\":50,\"connectedTo\":4,\"shapeIn\":[25,28,28,1],\"shapeOut\":[25,28,28,1],\"activation\":null,\"parameters\":{\"data\":\"MNIST\",\"datasetID\":\"\",\"inputShape\":[28,28,1]}},\"1\":{\"name\":\"output1\",\"ID\":1,\"type\":\"output\",\"x\":300,\"y\":50,\"connectedTo\":null,\"shapeIn\":[25,288],\"shapeOut\":[25,10],\"activation\":null,\"parameters\":{\"data\":\"MNIST\",\"outputShape\":[10]}},\"4\":{\"name\":\"conv4\",\"ID\":4,\"type\":\"conv\",\"x\":93.22129625745828,\"y\":45.02453806961887,\"connectedTo\":5,\"shapeIn\":[25,28,28,1],\"shapeOut\":[25,13,13,8],\"activation\":null,\"parameters\":{\"filters\":8,\"kernelSize\":[3,3],\"stride\":2}},\"5\":{\"name\":\"maxpool5\",\"ID\":5,\"type\":\"maxpool\",\"x\":164.94433122077317,\"y\":50.04710123987789,\"connectedTo\":6,\"shapeIn\":[25,13,13,8],\"shapeOut\":[25,6,6,8],\"activation\":null,\"parameters\":{\"poolSize\":[2,2]}},\"6\":{\"name\":\"flatten6\",\"ID\":6,\"type\":\"flatten\",\"x\":227.27825598586503,\"y\":17.505554649411522,\"connectedTo\":1,\"shapeIn\":[25,6,6,8],\"shapeOut\":[25,288],\"activation\":null,\"parameters\":{}}},\"modelInfo\":{\"epochs\":\"2\",\"batchSize\":\"25\",\"maxToken\":null,\"loss\":\"cce\",\"optimizer\":\"adam\",\"learningRate\":\"0.01\"}}');\n\nexport const denseModel = JSON.parse('{\"model\":{\"0\":{\"name\":\"input0\",\"ID\":0,\"type\":\"input\",\"x\":20,\"y\":50,\"connectedTo\":2,\"shapeIn\":[25,500],\"shapeOut\":[25,500],\"activation\":null,\"parameters\":{\"data\":\"IMDB\",\"datasetID\":\"\",\"inputShape\":[500]}},\"1\":{\"name\":\"output1\",\"ID\":1,\"type\":\"output\",\"x\":300,\"y\":50,\"connectedTo\":null,\"shapeIn\":[25,128],\"shapeOut\":[25,2],\"activation\":null,\"parameters\":{\"data\":\"MNIST\",\"outputShape\":[2]}},\"2\":{\"name\":\"embedding2\",\"ID\":2,\"type\":\"embedding\",\"x\":75.94492317196415,\"y\":64.44874382584419,\"connectedTo\":3,\"shapeIn\":[25,500],\"shapeOut\":[25,500,100],\"activation\":null,\"parameters\":{\"units\":100}},\"3\":{\"name\":\"flatten3\",\"ID\":3,\"type\":\"flatten\",\"x\":153.95333629131653,\"y\":24.011553705551506,\"connectedTo\":4,\"shapeIn\":[25,500,100],\"shapeOut\":[25,50000],\"activation\":null,\"parameters\":{}},\"4\":{\"name\":\"dense4\",\"ID\":4,\"type\":\"dense\",\"x\":207.20185248114421,\"y\":39.051709968596924,\"connectedTo\":1,\"shapeIn\":[25,50000],\"shapeOut\":[25,128],\"activation\":null,\"parameters\":{\"units\":128}}},\"modelInfo\":{\"epochs\":\"2\",\"batchSize\":\"25\",\"maxToken\":1000,\"loss\":\"cce\",\"optimizer\":\"adam\",\"learningRate\":\"0.01\"}}');","import React from 'react';\nimport Collapsible from 'react-collapsible';\nimport \"./Sidebar.css\";\nimport {nodeTypes, layerNames, activationNames} from \"./ModelInfo.js\";\n\nfunction SidebarHeader(props) {\n  /* the header (top left corner) of the sidebar */\n  const selectedClassName = \"btn btn-dark btn-block\";\n  const unselectedClassName = \"btn btn-outline-dark btn-block\";\n  return (\n    <div className=\"sidebar-header\">\n        <button type=\"button\" \n                className={props.tabSelected === \"edit\" ? selectedClassName : unselectedClassName }\n                onClick={() => props.changeTab(\"edit\")}>\n                Edit\n        </button>\n        <button type=\"button\" \n                className={props.tabSelected === \"train\" ? selectedClassName : unselectedClassName}\n                onClick={() => props.changeTab(\"train\")}>\n                Train\n        </button>\n    </div>\n  )\n}\n\nfunction CTAList() {\n  /* the credits on the bottom left corner */\n  return (\n    <ul className=\"list-unstyled CTAs\">\n      <li>\n        <a href=\"https://www.github.com/alexding123/NN-Flowchart\" className=\"download\">Download source</a>\n      </li>\n    </ul>\n  )\n}\n\nfunction Button(props) {\n  /* a button to be displayed on the sidebar */\n  return (\n    <div className=\"p-2 align-self-stretch button-container\">\n      <button className=\"btn btn-sm btn-dark btn-block\" onClick={props.onClick} disabled={props.disabled}>\n        {props.children}\n      </button>\n    </div>\n  );\n}\n\nfunction Layer(props) {\n  /* returns a button to create a layer */\n  return (\n    <Button onClick={() => props.newModel(props.name)}>\n      {nodeTypes[props.name].name}\n    </Button>\n  )\n}\n\nfunction Activation(props) {\n  /* returns a button to append an activation */\n  return (\n    <Button onClick={() => props.newActivation(props.name)}>\n      {nodeTypes[props.name].name}\n    </Button>\n  );\n}\n\nclass EditElements extends React.Component {\n  /* the sidebar when it's under the edit bar */\n  constructor(props) {\n    super(props);\n    this.props = props;\n    this.propsOri = props.propsOri;\n    this.setActivation = this.setActivation.bind(this);\n  }\n\n  setActivation(name) {\n    /* set the selected model to a particular activation function */\n    // must have a layer selected\n    if (this.props.selected === -1) {\n      this.props.setError(\"Select a layer to add the activation to first!\", true);\n      return;\n    }\n    const selected = this.props.models[this.props.selected];\n\n    // cancel activation if model is not activation-capatible\n    if (!nodeTypes[selected.type].canActivation) {\n      return;\n    }\n    // cancel the existing activation if it's the same as this\n    if (selected.activation === name) {\n      this.props.update(this.props.selected, {\n        activation: null,\n      });\n    } else {\n      this.props.update(this.props.selected, {\n        activation: name,\n      });\n    }\n  }\n  \n  render() {\n    const triggerName = \"trigger\";\n    const triggerOpenName = \"trigger active\";\n    return <React.Fragment>\n      <Collapsible trigger=\"Layers\" triggerTagName=\"p\" id=\"layers-toggle\" triggerClassName={triggerName} triggerOpenedClassName={triggerOpenName} onOpen={() => this.propsOri.update(\"layers\", false)} onClose={() => this.propsOri.update(\"layers\", true)} open={!this.propsOri.layersCollapsed}>\n        <div className=\"d-flex flex-column\">\n        { layerNames.map((name) => \n          <Layer key={name}\n            name={name}\n            newModel={this.props.newModel}\n          />)\n        }\n        </div>\n      </Collapsible>\n      <Collapsible trigger=\"Activations\" triggerTagName=\"p\" triggerClassName={triggerName} triggerOpenedClassName={triggerOpenName} onOpen={() => this.propsOri.update(\"activations\", false)} onClose={() => this.propsOri.update(\"activations\", true)} open={!this.propsOri.activationsCollapsed}>\n      <div className=\"d-flex flex-column\">\n      { activationNames.map((name) => \n        <Activation key={name} \n          name={name} \n          newActivation={() => this.setActivation(name)}\n        />\n        )\n      }\n      </div>\n      </Collapsible>\n    </React.Fragment>\n  }\n}\n\nfunction TrainElements(propOri) {\n  /* the display of the sidebar when it is under the train tab */\n  const props = propOri.props;\n  const isTraining = props.trainingInfo[\"training\"];\n\n  // train if not training, cancel button if training\n  const trainButton = (!isTraining) ? \n                 <Button onClick={props.trainCloud}>Train on Cloud</Button> : \n                 <Button onClick={props.cancelTrain}>Cancel</Button>;\n  return (\n    <React.Fragment>\n      <p>Server</p>\n      <Button onClick={props.setSelectModelPage} disabled={isTraining}>New/Load</Button>\n      <Button onClick={props.getLink}>Generate Link</Button>\n      \n      <p>Model</p>\n      {trainButton}\n      <Button onClick={props.downloadModel}>Download Model</Button>\n\n      <p>Input</p>\n      <Button onClick={props.setInput}>Set Input</Button>\n      \n    </React.Fragment>\n  )\n}\n\nfunction ElementsContainer(props) {\n  /* the container of a list of buttons */\n  const propsExtracted = props.props;\n  const Elements = props.tabSelected === \"edit\" ? <EditElements propsOri={props} models={propsExtracted.models} selected={propsExtracted.selected} setError={propsExtracted.setError} newModel={propsExtracted.newModel} update={propsExtracted.update}/>: <TrainElements props={propsExtracted}/>;\n  return (\n    <ul className=\"list-unstyled components\">\n      {Elements}\n    </ul>\n  )\n}\n\nexport class Sidebar extends React.Component {\n  /* the master sidebar to the left */\n  constructor(props) {\n    super(props);\n    this.props = props\n    this.state = {\n      tabSelected: \"edit\", // which tab is selected\n      layersCollapsed: false, // whether the accordion tab is collapsed\n      activationsCollapsed: false,\n    };\n    this.changeTab = this.changeTab.bind(this);\n    this.set = this.set.bind(this);\n  }\n\n  set(name, v) {\n    /* set whether the tab is collapsed */\n    if (name === \"layers\") {\n      this.setState({layersCollapsed: v});\n    } else if (name === \"activations\") {\n      this.setState({activationsCollapsed: v});\n    }\n  }\n\n  changeTab(tab) {\n    /* updates the current tab selected */\n    this.setState({\n      tabSelected: tab\n    })\n  }\n\n  render() {\n    return (\n      <nav className=\"p-2 h-100\" id=\"sidebar\">\n        <SidebarHeader tabSelected={this.state.tabSelected} changeTab={this.changeTab} />\n        <ElementsContainer tabSelected={this.state.tabSelected} layersCollapsed={this.state.layersCollapsed} activationsCollapsed={this.state.activationsCollapsed} update={this.set} props={this.props}/>\n        <CTAList />\n      \n      </nav>\n    )\n  }\n  \n}","import React from 'react';\nimport {nodeTypes} from \"./ModelInfo.js\";\n\nexport class Group extends React.Component {\n  /* a class for one single model's svg */\n  constructor(props) {\n    super(props);\n    this.props = props;\n    this.onMouseDown = this.onMouseDown.bind(this);\n  }\n  \n  \n  onMouseDown(e) {\n    /* start a drag-n-drop when clicked */\n    const model = this.props.model;\n    this.props.handleDrag(e.clientX, e.clientY, model.ID);\n  }\n  \n  \n  render() {\n    const model = this.props.model;\n\n    return (\n      <g className={this.props.selected ? \"selected\" : \"\"}\n        onMouseDown={this.onMouseDown}\n        key={model.ID} \n        transform={\"translate(\" + String(model.x) + \",\" + String(model.y) + \")\"}\n        style={{userSelect: 'none'}} // to prevent selecting\n      >\n      {nodeTypes[model.type].svg(model)}\n      </g>\n    )\n  }\n  \n}","import React from 'react';\n\nexport function MarkerDefs(props) {\n  /* defines the marker for the lines drawn in the svg */\n  // arrowed line\n  return (\n    <defs>\n      <marker id=\"dot\" viewBox=\"0 0 10 10\" refX=\"5\" refY=\"5\"\n        markerWidth=\"5\" markerHeight=\"5\">\n        <circle cx=\"5\" cy=\"5\" r=\"3\" fill=\"black\" />\n      </marker>\n      <marker id=\"arrow\" markerWidth=\"4\" markerHeight=\"4\"\n      orient=\"auto\" refY=\"2\">\n        <path d=\"M0,0 L4,2 0,4\"/>\n      </marker>\n    </defs>\n  )\n  }\n  \nexport function Line(props) {\n  /* defines an actual svg line, with arrows and dotted\n   * if selected\n   */\n    const strokeDasharray = props.tentative ? \"5,5\" : null;\n    const className = props.selected ? \"selected\" : null;\n    const onClick = props.tentative ? null : props.onClick;\n    let pointerEvents = props.tentative ? \"none\" : null;\n    if (\"pointerEvents\" in props) {\n      pointerEvents = props.pointerEvents;\n    }\n    const midX = (props.x1+props.x2) / 2;\n    const midY = (props.y1+props.y2) / 2;\n    return (\n    <path d={\"M \"+props.x1+\" \"+props.y1+\n             \" L \"+midX+\" \"+midY+\n             \" L \"+props.x2+\" \"+props.y2}\n          onClick={onClick}\n          className={className}\n          pointerEvents={pointerEvents}\n          strokeDasharray={strokeDasharray} \n          stroke=\"black\" \n          strokeWidth=\"3\"\n          markerStart=\"url(#arrow)\"\n          markerMid=\"url(#arrow)\"\n          markerEnd=\"url(#dot)\"/>\n    );\n  }\n  ","export const DELETE_KEY = 8; // keycode\nexport const BASE_URL = \"http://localhost:5000/api/\"; //\"https://nn-flowchart.herokuapp.com/api/\"; \n\nexport const DATASET_SHAPE = {\n    \"MNIST\": {\n        \"input\": [28, 28, 1],\n        \"output\": [10],\n    },\n    \"IMDB\": {\n        \"input\": [500],\n        \"output\": [2],\n    }\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport \"./Canvas.css\";\nimport {nodeTypes} from \"./ModelInfo.js\";\nimport {Group} from \"./Group.js\";\nimport {MarkerDefs, Line} from \"./Line.js\";\nimport {DELETE_KEY} from \"./Constants.js\";\n\n\nfunction modelCenter(model) {\n  /* get coordinates for the point on a model to connect to\n   */\n  const offsetX = nodeTypes[model.type].offsetX\n  const offsetY = nodeTypes[model.type].offsetY\n  return {x: model.x+offsetX, y: model.y+offsetY}\n}\n\nclass Canvas extends React.Component {\n  /* the class implementing the actual svg and all the event\n   * listerers (along with its downstream elements)\n   * stores the mouse locations and such information to implement\n   * drag and drop\n   */\n  constructor(props) {\n    super(props);\n    this.props = props;\n    \n    this.state = {\n      isNewline: false, // is there a new line being constructed?\n      xOffset: 0, // offset of the svg's x from clientX\n      yOffset: 0, // ibid for y\n      x: 0, // x of the mouse relative to the svg\n      y: 0, // ibid for y\n      id: -1, // id of the line from which the current new line stems from\n      selectedLineFromTo: [-1,-1], // selected line from node X to node Y ([X,Y])\n      dragging: -1, // -1 means no dragging\n      initX: 0,\n      initY: 0,\n      initModelX: 0,\n      initModelY: 0,\n    }\n\n    // some function bindings\n    this.handleElementClick = this.handleElementClick.bind(this);\n    this.trackMouse = this.trackMouse.bind(this);\n    this.handleBGClick = this.handleBGClick.bind(this);\n    this.handleLineClick = this.handleLineClick.bind(this);\n    this.deleteSelection = this.deleteSelection.bind(this);\n    this.handleDrag = this.handleDrag.bind(this);\n    this.onMouseUp = this.onMouseUp.bind(this);\n  }\n\n  componentDidMount() {\n    // finds out the offsets of the svg\n    const dim = ReactDOM.findDOMNode(this).getBoundingClientRect();\n    this.setState({\n      xOffset: dim.x,\n      yOffset: dim.y,\n    });\n\n    // setup key listener for deletion\n    document.addEventListener(\"keydown\", this.deleteSelection);\n  }\n\n  componentWillUnmount() {\n    // reset\n    document.removeEventListener(\"keydown\", this.deleteSelection);\n  }\n\n  deleteSelection(e) {\n    /* delete the selected model */\n    // ignore delete if editing a parameter\n    if (this.props.editableSelected) {\n      return;\n    }\n    if (e.keyCode === DELETE_KEY) {\n      // prioritize items over line\n      // if an item is selected\n      if (this.props.selected !== -1) {\n        // first cancel a few things just in case (to prevent errors)\n        this.cancelNewline();\n        const selected = this.props.selected;\n        \n        // cannot delete input or output node\n        if (selected === 0 || selected === 1) {\n          return;\n        }\n        this.props.select(-1);\n\n        this.props.remove(selected);\n        return;\n      }\n\n      // delete selected line\n      const from = this.state.selectedLineFromTo[0];\n      const to = this.state.selectedLineFromTo[1];\n      if (from !== -1 || to !== -1) {\n        this.cancelNewline();\n        this.props.update(from, {\n          connectedTo: null,\n        });\n        return;\n      }\n    }\n  }\n\n  startNewline(id) {\n    /* starts the construction of a tentative new line */\n\n    this.setState( {\n      isNewline: true,\n      id: id,\n      selectedLineFromTo: [-1, -1], // reset line selection\n    });\n  }\n\n  cancelNewline() {\n    /* cancels the tentative new line */\n    this.setState({\n      isNewline: false,\n      id: -1,\n      selectedLineFromTo: [-1, -1], // reset line selection\n    })\n  }\n\n  trackMouse(e) {\n    /* a helper function to keep tracking mouse movement */\n    this.setState({\n      x: e.clientX - this.state.xOffset,\n      y: e.clientY - this.state.yOffset,\n    });\n\n    if (this.state.dragging !== -1) {\n      const newX = e.clientX + this.state.initModelX - this.state.initX;\n      const newY = e.clientY + this.state.initModelY - this.state.initY;\n      this.props.update(this.state.dragging, {\n        x: newX,\n        y: newY,\n      });\n    }\n  }\n\n  onMouseUp(e) {\n    /* when the click is released, stop the drag-n-drop\n     * and decide if it's an actual click\n     */\n    \n    if (this.state.dragging === -1) {\n      return;\n    }\n    const dragging = this.state.dragging;\n    const dragged = this.props.models[dragging];\n\n    // reset drag\n    this.setState({\n      dragging: -1,\n    });\n    \n    const threshold = 10;\n    // if movement is small enough, consider it a click\n    if (Math.abs(dragged.x - this.state.initModelX) + Math.abs(dragged.y - this.state.initModelY) < threshold) {\n      this.props.select(dragged.ID);\n      this.handleElementClick(dragged.ID);\n    }\n  }\n\n  handleBGClick(e) {\n    /* handles a click on the background */\n    if (e.target === this.refs.canvas) {\n      this.props.select(-1); // deselect elements\n      this.cancelNewline();\n      return;\n    }\n    // the rest is handled on handleElementClick\n  }\n\n  handleElementClick(id) {\n    /* handles a click to one of the elemnts, to be passed\n     * to the child classes of the canvas\n     */\n    // if this is a new line, clicked on another object\n    if (this.state.isNewline) {\n\n      // if the line is drawn to itself, ignore\n      if (this.state.id !== id) {\n        // update model so that new connection is made\n        this.props.update(this.state.id, {\n          connectedTo: id,\n        });\n        \n        // if the reverse connection exists, cancel it\n        if (this.props.models[id].connectedTo === this.state.id) {\n          this.props.update(id, {\n            connectedTo: null,\n          })\n        }\n      }\n      // remove temporary line\n      this.cancelNewline();\n      return;\n    }\n    // if no current line, start one\n    this.startNewline(id);\n  }\n\n  handleLineClick(idFrom, idTo) {\n    /* handles a click on the line, to be passed\n     * to the child class\n     */\n    this.setState({\n      selectedLineFromTo: [idFrom, idTo]\n    })\n    this.props.select(-1);\n  }\n\n  handleDrag(initX, initY, id) {\n    /* handle a new dragging session */\n    const model = this.props.models[id];\n    this.setState({\n      dragging: id,\n      initX: initX,\n      initY: initY,\n      initModelX: model.x,\n      initModelY: model.y\n    });\n    this.props.select(model.ID);\n  }\n\n  render() {\n    // let's do all the layers from the model first\n    const modelElements = Object.entries(this.props.models).map(([key, model]) => {\n\n    \n      return <Group key={model.ID} handleDrag={this.handleDrag} model={model} selected={this.props.selected===model.ID}/>;\n    });\n    \n    // this part handles rendering the tentative line (if any)\n    let tentativeLine = null;\n    if (this.state.isNewline) {\n      const coords = modelCenter(this.props.models[this.state.id]);\n      tentativeLine = <Line tentative={true} selected={true} x1={coords.x} y1={coords.y} x2={this.state.x} y2={this.state.y}/>\n    }\n\n    // renders all the lines between models\n    const lines = Object.entries(this.props.models).map(([index, model]) => {\n      // no line if there is no connection\n      if (model.connectedTo === null) {\n        return null;\n      }\n      const otherModel = this.props.models[model.connectedTo];\n      const coords = modelCenter(model);\n      const otherCoords = modelCenter(otherModel);\n      const selected = this.state.selectedLineFromTo[0]===model.ID && this.state.selectedLineFromTo[1] === otherModel.ID;\n\n      return <Line key={index} tentative={false} selected={selected} x1={coords.x} y1={coords.y} x2={otherCoords.x} y2={otherCoords.y} onClick={() => this.handleLineClick(model.ID, otherModel.ID)}></Line>\n    })\n\n    \n    return (\n      // stick a rect for background\n      <svg onClick={this.handleBGClick} onMouseMove={this.trackMouse} onMouseUp={this.onMouseUp} id=\"canvas\" width=\"100%\" height=\"60%\" ref=\"canvas\">\n        <MarkerDefs/>\n        <rect width=\"100%\" height=\"100%\" fill=\"#b477ec\" pointerEvents=\"none\"/>\n        {modelElements}\n        {lines}\n        {tentativeLine}\n      </svg>\n    )\n  }\n  \n}\n\nfunction Padding(props) {\n  /* just padding to make the main canvas look better */\n  return (\n    <svg width=\"100%\" height=\"20%\">\n      <rect width=\"100%\" height=\"100%\" fill=\"blueviolet\"/>\n    </svg>\n  )\n}\n\nexport function CanvasContainer(props) {\n  /* contains the main section of the page yay */\n  return (\n    // padding on top and below to look extra good\n    <div className=\"p-2 flex-grow-1 canvas-container no-margin\"> \n      <Padding/>\n      <Canvas models={props.models} editableSelected={props.editableSelected} selected={props.selected} select={props.select} update={props.update} remove={props.remove}/>\n      <Padding/>\n    </div>\n  );\n}","import React from \"react\";\nimport \"./Toolbar.css\";\nimport {nodeTypes} from \"./ModelInfo.js\";\n\nfunction DisplayLine(props) {\n  /* Returns a line of view-only parameter */\n  return (\n    <div className=\"parameter-line\">\n      <div className=\"parameter-name\">{props.name}:</div>\n      <div className=\"parameter-value\">{props.value}</div>\n    </div>\n  )\n}\n\nclass EditableLine extends React.Component {\n  /* a line of parameters that is editable */\n  constructor(props) {\n    super(props);\n    this.props = props;\n    this.state = {\n      valueChanged: false,\n      currentValue: null,\n    };\n    // handles: \n    // onFocus -- reports to parent that editable is selected\n    // onChange -- updates and stores internal value\n    // onBlur -- callbacks to update the model and reset the internal state\n    this.onFocus = () => this.props.setEditableSelected(true);\n    this.onChange = this.onChange.bind(this);\n    this.onBlur = (value) => {\n      this.setState({\n        valueChanged: false,\n        currentValue: null,\n      });\n      this.props.setEditableSelected(false);\n      this.props.callback(this.props.paraName, value);\n    };\n  }\n\n  onChange(event) {\n    /* update the value of the parameter when changed */\n    const value = event.target.value;\n\n    this.setState({\n      valueChanged: true,\n      currentValue: value,\n    });\n  }\n\n  render() {\n    const oldValue = this.props.parameters[this.props.paraName];\n    // display oldValue if no value is changed\n    const value = (this.state.valueChanged ? this.state.currentValue : oldValue);\n\n    return (\n      <div className=\"parameter-line\">\n        <div className=\"parameter-name\">{this.props.name}</div>\n        <input className=\"parameter-input\" onFocus={this.onFocus} onBlur={() => this.onBlur(value)} onChange={this.onChange} value={value}></input>\n      </div>\n    )\n  } \n}\n\nfunction DataInput(props) {\n  /* the line allowing setting of dataset */\n  return (\n    <div className=\"parameter-line\">\n      <div className=\"parameter-name\">Dataset</div>\n      <div className=\"parameter-input parameter-clickable\" onClick={props.setInputDataset}>{props.value}</div>\n      \n    </div>\n  );\n}\n\nfunction Parameters(props) {\n  /* Returns a list of lines of editable parameters */\n  const model = props.model;\n  if (model === null) {\n    return null;\n  }\n\n  // differs depending on model type\n  switch (model.type) {\n    case \"dense\":\n      return (\n        <React.Fragment>\n          <EditableLine name=\"Units\" paraName=\"units\" setEditableSelected={props.setEditableSelected} parameters={model.parameters} callback={(n,v)=>props.callback(n,v,false)}/>\n        </React.Fragment>\n      );\n    case \"conv\":\n      return (\n        <React.Fragment>\n          <EditableLine name=\"Filters\" paraName=\"filters\" setEditableSelected={props.setEditableSelected} parameters={model.parameters} callback={(n,v)=>props.callback(n,v,false)}/>\n          <EditableLine name=\"Kernel Size\" paraName=\"kernelSize\" setEditableSelected={props.setEditableSelected} parameters={model.parameters} callback={(n,v)=>props.callback(n,v,true)}/>\n          <EditableLine name=\"Stride\" paraName=\"stride\" setEditableSelected={props.setEditableSelected} parameters={model.parameters} callback={(n,v)=>props.callback(n,v,true)}/>\n        </React.Fragment>\n      )\n    case \"input\":\n      return (\n        <React.Fragment>\n          <DataInput value={model.parameters.data} setInputDataset={props.setInputDataset}></DataInput>\n        </React.Fragment>\n      )\n    case \"maxpool\":\n      return (\n        <React.Fragment>\n          <EditableLine name=\"Pool Size\" paraName=\"poolSize\" setEditableSelected={props.setEditableSelected} parameters={model.parameters} callback={(n,v)=>props.callback(n,v,true)}/>\n        </React.Fragment>\n      )\n    case \"embedding\":\n      return (\n        <React.Fragment>\n          <EditableLine name=\"Units\" paraName=\"units\" setEditableSelected={props.setEditableSelected} parameters={model.parameters} callback={(n,v)=>props.callback(n,v,false)}/>\n        </React.Fragment>\n      )\n    case \"dropout\":\n      return (\n        <React.Fragment>\n          <EditableLine name=\"Rate\" paraName=\"rate\" setEditableSelected={props.setEditableSelected} parameters={model.parameters} callback={(n,v)=>props.callback(n,v,false,true)}/>\n        </React.Fragment>\n      )\n    default:\n      return null;\n  }\n}\n\nexport function Toolbar(props) {\n  /* the master toolbar to the bottom */\n\n  // if no model is selected, show training information\n  if (props.selected === -1) {\n    const modelInfo = props.modelInfo;\n    const trainingInfo = props.trainingInfo;\n    const loss = (trainingInfo.loss === null) ? \"N/A\" : trainingInfo.loss;\n    const accuracy = (trainingInfo.accuracy === null) ? \"N/A\" : trainingInfo.accuracy;\n    const testAccuracy = (trainingInfo.testAccuracy === null) ? \"N/A\" : trainingInfo.testAccuracy;\n    const progress = (trainingInfo.progress === null) ? \"0.0%\" : trainingInfo.progress;\n    return (\n      <nav className=\"p-2 no-margin\" id=\"toolbar\">\n        <div id=\"toolbar-container\">\n          <div className=\"left-line\">\n            <p>Model Information</p>\n            <EditableLine name=\"Epochs\" paraName=\"epochs\" setEditableSelected={()=>null} parameters={modelInfo} callback={(n,v) => props.updateModelInfo(n,v,true)}/>\n            <EditableLine name=\"Batch Size\" paraName=\"batchSize\" setEditableSelected={()=>null} parameters={modelInfo} callback={(n,v) => props.updateModelInfo(n,v,true)}/>\n            <button onClick={props.trainSetup} className=\"btn btn-sm btn-light btn-block\">More</button>\n          </div>\n          <div className=\"blocker\"></div>\n          <div className=\"middle-line\">\n            <p>Train Information</p>\n            <DisplayLine name=\"Training\" value={trainingInfo.training ? \"Yes\" : \"No\"}/>\n            <DisplayLine name=\"Progress\" value={progress}/>\n          </div>\n          <div className=\"blocker\"></div>\n          <div className=\"right-line\">\n            <br></br>\n            <DisplayLine name=\"Accuracy\" value={accuracy}/>\n            <DisplayLine name=\"Loss\" value={loss}/>\n            <DisplayLine name=\"Test Acc\" value={testAccuracy}/>\n          </div>\n        </div>\n      </nav>\n    )\n  }\n\n  // if a model is selected...\n  // show the model's parameters page\n  const model = props.models[props.selected];\n\n  const type = nodeTypes[model.type].name;\n  const activation = (model.activation === null) ? \"None\" : nodeTypes[model.activation].name;\n  const incomingShape = (model.shapeIn === null ? \"N/A\" : String(model.shapeIn));\n  const outgoingShape = (model.shapeOut === null ? \"N/A\" : String(model.shapeOut));\n  return (\n    <nav className=\"p-2 no-margin\" id=\"toolbar\">\n      <div id=\"toolbar-container\">\n        \n        <div className=\"left-line\">\n          <p>Parameters</p>\n          <Parameters model={model} callback={props.update} setEditableSelected={props.setEditableSelected} setInputDataset = {props.setInputDataset}/>\n        </div>\n        <div className=\"blocker\"></div>\n        <div className=\"middle-line\">\n          <p>Layer Information</p>\n          <DisplayLine name=\"Type\" value={type}/>\n          <DisplayLine name=\"Activation\" value={activation}/>\n        </div>\n        <div className=\"blocker\"></div>\n        <div className=\"right-line\">\n          <br></br>\n          <DisplayLine name=\"Shape In\" value={incomingShape}/>\n          <DisplayLine name=\"Shape Out\" value={outgoingShape}/>\n        </div>\n      </div>\n    </nav>\n  )\n}","import React from 'react';\nimport \"./ErrorBox.css\";\n\nexport function ErrorBox(props) {\n  /* Renders a dismissable error message */\n  // display nothing if no error message\n  if (props.errorMsg === null) {\n    return null;\n  }\n  if (props.dismissible) {\n    return (\n      <div className=\"position-absolute float-box\">\n        <div className=\"alert alert-danger alert-dismissible position-absolute w-100\">\n          <strong>Error:</strong> {props.errorMsg}\n          <button type=\"button\" className=\"close\" data-dismiss=\"alert\" aria-label=\"Close\" \n                  onClick={() => props.setError(null, true)}>\n            <span aria-hidden=\"true\">&times;</span>\n          </button>\n        </div>\n      </div>\n    )\n  }\n  return (\n    <div className=\"position-absolute float-box\">\n      <div className=\"alert alert-danger position-absolute w-100\">\n        <strong>Error:</strong> {props.errorMsg}\n      </div>\n    </div>\n  )\n}\n","import React from 'react';\nimport \"./SelectModel.css\";\n\nexport class SelectModel extends React.Component {\n  /* the page selecting a model */\n  constructor(props) {\n    super(props);\n    this.props = props;\n    this.state = {\n      err: null,\n      link: null,\n    }\n\n    this.onChange = this.onChange.bind(this);\n    this.noChange = this.noChange.bind(this);\n    this.loadModel = this.loadModel.bind(this);\n    this.setError = this.setError.bind(this);\n  }\n\n  setError(err) {\n    /* set local error (to be displayed as small text) */\n    this.setState({err:err})\n  }\n\n  loadModel() {\n    /* load a custom model */\n    this.props.loadModel(this.state.link, this.setError);\n  }\n\n  onChange(e) {\n    /* when the textbox is editted */\n    this.setState({link:e.target.value});\n  }\n\n  noChange(e) {\n    /* the model selection is cancelled and nothing is done \n     * if the user clicks on the background\n     */\n    if (e.target.id === \"background-model-select\" || e.target.id === \"model-blocker\") {\n      this.props.toggle();\n    }\n  }\n  render() {\n    // empty if not displaying\n    if (!this.props.display) {\n      return null;\n    }\n    return (\n      <div id=\"background-model-select\" onClick={this.noChange} className=\"select-model-container\">\n        <h1>Load a Model</h1>\n        <div className=\"model-container\">\n          <div className=\"model-new\">\n            <h2>New Model</h2>\n            <div className=\"d-flex flex-wrap p-2\">\n              <div className=\"p-2\"><button type=\"button\" onClick={() => this.props.loadDefaultModel(\"blank\")} className=\"btn btn-secondary\">Blank</button></div>\n              <div className=\"p-2\"><button type=\"button\" onClick={() => this.props.loadDefaultModel(\"dense\")} className=\"btn btn-secondary\">Dense</button></div>\n              <div className=\"p-2\"><button type=\"button\" onClick={() => this.props.loadDefaultModel(\"conv\")} className=\"btn btn-secondary\">Conv</button></div>\n            </div>\n            \n          </div>\n          <div id=\"model-blocker\" className=\"model-blocker\"></div>\n          <div className=\"model-load\">\n            <h2>Load Model</h2>\n            <label>Model link</label>\n            <input type=\"text\" className=\"form-control\" placeholder=\"Enter model link\" onChange={this.onChange}></input>\n            <small className=\"form-text text-muted\">{this.state.err}</small>\n            <br></br>\n            <button type=\"button\" className=\"btn btn-secondary\" onClick={this.loadModel}>Load</button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n  \n}","import React from 'react';\nimport \"./LinkPage.css\";\n\nexport function LinkPage(props) {\n  /* the page showing a link is generated */\n  if (!props.display) {\n    return null;\n  }\n  // some code to copy the link to clipboard\n  // create a dummy element with the link as text\n  // select it and copy the text\n  var dummy = document.createElement(\"textarea\");\n  document.body.appendChild(dummy);\n  dummy.value = props.link;\n  dummy.select();\n  document.execCommand(\"copy\");\n  document.body.removeChild(dummy);\n  return (\n    <div onClick={e=>{\n      if (e.target.id === \"linkpage-container\" || e.target.id === \"linkpage-content\") {\n        props.toggle();\n      }\n    }} className=\"linkpage-container\" id=\"linkpage-container\">\n      <div className=\"linkpage-content\" id=\"linkpage-content\">\n      <h1>Model Link</h1>\n      <input readOnly className=\"form-control\" type=\"text\" value={props.link}/>\n      <small className=\"form-text text-muted\">{\"Link copied to clipboard\"}</small>\n      </div>\n    </div>\n  );\n  \n}","import React from 'react';\nimport \"./SetInput.css\";\n\nexport class SetInput extends React.Component {\n  /* the page to select an input dataset */\n  constructor(props) {\n    super(props);\n    this.props = props;\n    this.state = {\n      err: null, // internal error\n      name: \"\", // name of dataset\n      link: \"\", // link to dataset\n      inputShape: [], // user-specified shape\n      outputShape: [],\n      inputShapeDisplay: \"\", // texts to display the corresponding shapes\n      outputShapeDisplay: \"\",\n    }\n\n    this.onChange = this.onChange.bind(this);\n    this.noChange = this.noChange.bind(this);\n    this.setError = this.setError.bind(this);\n    this.onChangeShapeInput = this.onChangeShapeInput.bind(this);\n    this.onChangeShapeOutput = this.onChangeShapeOutput.bind(this);\n    this.onChangeName = this.onChangeName.bind(this);\n    this.onBlurInput = this.onBlurInput.bind(this);\n    this.onBlurOutput = this.onBlurOutput.bind(this);\n  }\n\n  setError(err) {\n    /* set internal error */\n    this.setState({err:err})\n  }\n\n  onChange(e) {\n    /* update the link's text */\n    this.setState({link:e.target.value});\n  }\n\n  breakShape(value) {\n    /* helper function to break down a string describing an array\n     * into an actual array\n     */\n    let components = String(value).split(\",\");\n\n    // do not accept empty inputs\n    if (components.length === 0) {\n      return [];\n    }\n    for (var i = 0; i < components.length; i++) {\n      const num = parseInt(components[i]);\n      // do not update if any member of tuple is not a number\n      if (isNaN(num)) {\n        return null;\n      }\n      components[i] = num;\n    }\n    return components;\n  }\n\n  toString(shape) {\n    /* convert an array into its string representation */\n    if (shape.length === 0) {\n      return \"\";\n    }\n    return shape.join(\",\");\n  }\n\n  onChangeShapeInput(e) {\n    /* change the input shape's display (its string) */\n    this.setState({\n      inputShapeDisplay: e.target.value,\n    })\n  }\n\n  onBlurInput(e) {\n    /* update the input shape to reflect the user input \n     * (stored in inputShapeDisplay), rejecting it if\n     * malformed\n     */\n\n    const components = this.breakShape(e.target.value);\n    // reject the shape if malformed\n    if (components === null) {\n      this.setState({\n        inputShapeDisplay: this.toString(this.state.inputShape),\n      });\n      return;\n    }\n    this.setState({\n      inputShape: components,\n      inputShapeDisplay: this.toString(components)\n    });\n  }\n\n  onChangeShapeOutput(e) {\n    /* change the output shape's display (its string) */\n    this.setState({\n      outputShapeDisplay: e.target.value,\n    });\n  }\n\n  onBlurOutput(e) {\n    /* update the output shape to reflect the user output \n     * (stored in outputShapeDisplay), rejecting it if\n     * malformed\n     */\n    const components = this.breakShape(e.target.value);\n    // reject the shape if malformed\n    if (components === null) {\n      this.setState({\n        outputShapeDisplay: this.toString(this.state.outputShape),\n      });\n      return;\n    }\n    this.setState({\n      outputShape: components,\n      outputShapeDisplay: this.toString(components),\n    });\n  }\n  \n  onChangeName(e) {\n    /* update the name of the dataset */\n    this.setState({\n      name: e.target.value,\n    })\n  }\n\n  noChange(e) {\n    /* cancel this page without any changes if background is clicked */\n    if (e.target.id === \"background-input-set\" || e.target.id === \"input-blocker\") {\n      this.props.toggle();\n    }\n  }\n\n  render() {\n    if (!this.props.display) {\n      return null;\n    }\n    return (\n      <div id=\"background-input-set\" onClick={this.noChange} className=\"set-input-container\">\n      <h1>Load Input Dataset</h1>\n      <div className=\"input-container\">\n        <div className=\"input-preset\">\n          <h2>Load Preset</h2>\n          <div className=\"d-flex flex-wrap p-2\">\n            <div className=\"p-2\"><button type=\"button\" onClick={() => this.props.loadDefaultInput(\"MNIST\")} className=\"btn btn-secondary\">MNIST</button></div>\n            <div className=\"p-2\"><button type=\"button\" onClick={() => this.props.loadDefaultInput(\"IMDB\")} className=\"btn btn-secondary\">IMDB</button></div>\n          </div>\n          \n        </div>\n        <div id=\"input-blocker\" className=\"input-blocker\"></div>\n        <div className=\"input-load\">\n          <h2>Load Custom Dataset</h2>\n          <div className=\"form-group\">\n            <input type=\"text\" className=\"form-control\" placeholder=\"Enter input URL\" onChange={this.onChange} value={this.state.link}></input>\n          </div>\n          <input type=\"text\" className=\"form-control\" placeholder=\"Name\" onChange={this.onChangeName} value={this.state.name}></input>\n          <small className=\"form-text\">Shape does not include batchSize</small>\n          <div className=\"form-row\">\n            \n            <div className=\"col\">\n              <input type=\"text\" className=\"form-control\" placeholder=\"Input shape\" onChange={this.onChangeShapeInput} onBlur={this.onBlurInput} value={this.state.inputShapeDisplay}></input>\n            </div>\n            <div className=\"col\">\n              <input type=\"text\" className=\"form-control\" placeholder=\"Output shape\" onChange={this.onChangeShapeOutput} onBlur={this.onBlurOutput} value={this.state.outputShapeDisplay}></input>\n            </div>\n          </div>         \n          \n          <small className=\"form-text text-muted\">{this.state.err}</small> \n          <br></br>\n          <button type=\"button\" className=\"btn btn-secondary\" onClick={()=>this.props.loadInput(this.state.link, this.state.name, this.state.inputShape, this.state.outputShape, this.setError)}>Load</button>\n        </div>\n      </div>\n    </div>\n    );\n  }\n}","export function isCyclic(models) {\n  /* Checks if the models constitute directed acyclic graphs\n   * (Potentially multiple acyclic graphs)\n   * Returns false only if there is an internal loop\n   */\n  let visited = {}; // whether the node is visited\n  let inRecursionStack = {}; // whether the node is in the currentfunction call stack\n\n  for (const key of Object.keys(models)) {\n    visited[key] = false;\n    inRecursionStack[key] = false;\n  }\n\n  for (const key of Object.keys(models)) {\n    if (isCyclicHelper(models, key, visited, inRecursionStack)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction isCyclicHelper(models, index, visited, inRecursionStack) {\n  /* A helper function to explore from a single node. Returns\n   * false if there is no discrepancy found from this index \n   */\n\n  // if visited, remove out of stack and say no\n  if (visited[index]) {\n    inRecursionStack[index] = false;\n    return false;\n  }\n\n  visited[index] = true;\n  inRecursionStack[index] = true;\n  // if no neighbor, then no discrepancy\n  if (models[index].connectedTo === null) {\n    inRecursionStack[index] = false; \n    return false;\n  }\n\n  const next = models[index].connectedTo;\n  if (!visited[next] && isCyclicHelper(models, next, visited, inRecursionStack)) {\n    return true;\n  }\n  // if we bump into a node on our incoming path, it's bad\n  if (inRecursionStack[next]) {\n    return true;\n  }\n\n  inRecursionStack[index] = false;\n  return false;\n}\n\nexport function isLinear(models) {\n  /* checks if the model current makes sense:\n   * all nodes cannot have > 1 incoming edge\n   * input node cannot have incoming edge\n   * output node cannot have outgoing edge\n   */ \n  let numIncomingEdges = {};\n  for (const key of Object.keys(models)) {\n    numIncomingEdges[key] = 0;\n  }\n\n  for (const key of Object.keys(models)) {\n    const next = models[key].connectedTo;\n    if (next !== null) {\n      numIncomingEdges[next] += 1;\n    }\n  }\n\n  // the input node must not have incoming edges\n  if (numIncomingEdges[0] !== 0) {\n    return {ok: false, err: \"Input node cannot have incoming edge\"};\n  }\n  // the output node must not have outgoing edges\n  if (models[1].connectedTo !== null) {\n    return {ok: false, err: \"Output node cannot have outgoing edge\"}; \n  }\n  for (const key of Object.keys(models)) {\n    if (numIncomingEdges[key] > 1) {\n      return {\"ok\": false, err:\"No node can have more than one incoming edge\"};\n    }\n  }\n  return {\"ok\": true, err:\"\"};\n}\n\nexport function prev(models, id) {\n  /* Returns id of the node linking to the model pointed \n   * to by the id, if any; if none, return null \n   */\n  for (const key of Object.keys(models)) {\n    if (models[key].connectedTo === id) {\n      return key;\n    }\n  }\n  return null;\n}\n\nexport function isTrainable(models) {\n  /* Is the current architecture trainable? */\n  const resp = isLinear(models);\n  // if not linear, then fail\n  if (!resp[\"ok\"]) {\n    return resp;\n  }\n  if (isCyclic(models)) {\n    return {ok: false, err: \"Model cannot be cyclic\"};\n  }\n  \n  // output node must not be empty, \n  // have ndim = 2, and agree with batch size\n  if (models[1].shapeIn === null || models[1].shapeOut.length !== 2) {\n    return {ok: false, err: \"Output node must have shape (batchSize, categories)\"};\n  }\n\n  let currentNode = models[0]; // input node\n  while (currentNode.ID !== 1) { // need to reach output node\n    if (currentNode.connectedTo === null) {\n      return {ok: false, err: \"Model does not connect from input node to output node\"};\n    }\n    currentNode = models[currentNode.connectedTo];\n  }\n  return {ok: true, err: \"\"};\n}","import {BASE_URL} from \"./Constants.js\";\n\n// functions to communicate with the server\n\nexport function getModel(modelID) {\n  /* get a model given its id from the server */\n  return fetch(BASE_URL+\"Architecture?id=\"+modelID).then(response => { \n    if (response.status === 200 || response.status === 404 || response.status === 400) {\n      return response.json();\n    }\n    throw new Error(\"Something went wrong when getting model\");\n  }).then(json => {\n    if ('message' in json) {\n      throw new Error(json['message']);\n    }\n    return json.data['modelJSON'];\n  })\n}\n\nexport function saveModel(serializedModel) {\n  /* save the serialized model to the server and returns its id */\n  return fetch(BASE_URL+'Architecture', {\n    method: 'POST',\n    headers: {\n      'Accept': 'application/json',\n      'Content-Type': 'application/json',\n    },\n    body: serializedModel,\n  }).then(response => {\n    if (response.status === 201) {\n      return response.json();\n    } else {\n      throw new Error(\"Something went wrong\");\n    }\n  })\n}\n\nexport function startSession(id) {\n  /* start a new training session given the model id */\n  return fetch(BASE_URL+\"Train\", {\n    method: \"POST\",\n    headers: {\n      'Accept': 'application/json',\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({id:id}),\n  }).then(response => {\n    if (response.status === 201) {\n      return response.json();\n    }\n    throw new Error(\"Internal error\");\n  });\n}\n\nexport function updateTrain(sessionID) {\n  /* get the latest training status of a training session */\n  return fetch(BASE_URL+\"Train?id=\"+sessionID).then(response => {\n    if (response.status === 200) {\n      return response.json();\n    }\n    throw new Error(\"Training session failed to be fetched\");\n  })\n}\n\nexport function deleteTrain(sessionID) {\n  /* delete the training session given its session id */\n  return fetch(BASE_URL+\"Train\", {\n    method: \"DELETE\",\n    body: JSON.stringify({id:sessionID}),\n  });\n}\n\nexport function generateLink(id) {\n  /* generate a link for a saved model at the server */\n  return fetch(BASE_URL+\"Link\", {\n    method: \"POST\",\n    headers: {\n      'Accept': 'application/json',\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({modelID: id})\n  }).then(response => {\n    if (response.status === 201) {\n      return response.json();\n    }\n    throw new Error(\"Failed to generate link\");\n  })\n}\n\nexport function getIDFromLink(link) {\n  /* get the corresponding model ID from the link */\n  return fetch(BASE_URL+\"Link?link=\"+link).then(response => {\n    if (response.status === 200 || response.status === 404 || response.status === 400)\n      return response.json();\n    throw new Error(\"Something went wrong with retrieving ID from link\");\n  }).then(json => {\n    if ('message' in json) {\n      throw new Error(json['message']);\n    }\n    return json['id'];\n  })\n}\n\nexport function downloadModel(modelID) {\n  /* get the json download for the model from its model ID */\n  return fetch(BASE_URL+\"Download?id=\"+modelID).then(response => {\n    if (response.status === 200 || response.status === 404 || response.status === 400)\n      return response.json();\n    throw new Error(\"Something went wrong with downloading the model\");\n  }).then(json => {\n    if ('message' in json) {\n      throw new Error(json['message']);\n    }\n    return json['data'];\n  })\n}\n\nexport function loadInput(url, name, inputShape, outputShape) {\n  /* load the custom input from the server */\n  return fetch(BASE_URL+\"Dataset\", {\n    method: \"POST\",\n    headers: {\n      'Accept': 'application/json',\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\n      link: url,\n      datasetName: name,\n      inputShape: String(inputShape),\n      outputShape: String(outputShape),\n    })\n  }).then(response => {\n    if (response.status === 201 || response.status === 404 || response.status === 400) \n      return response.json();\n    throw new Error(\"Something went wrong when loading the input\");\n  }).then(json => {\n    console.log(json);\n    if ('message' in json) {\n      throw new Error(json['message']);\n    }\n    return json['data'];\n  });\n}","import React from \"react\";\nimport \"./TrainSetup.css\";\n\nfunction Option(props) {\n  /* one option on the list, specially shown if selected */\n  const className = (props.selected === props.name) ? \"btn btn-info\" : \"btn btn-secondary\"\n  return (\n    <div className=\"p-2\">\n      <button type=\"button\" onClick={() => props.select(props.name)} className={className}>{props.displayName}</button>\n    </div>\n  )\n}\n\nexport class TrainSetup extends React.Component {\n  /* the page setting details of training configuration */\n  constructor(props) {\n    super(props);\n    this.props = props;\n\n    this.onClick = this.onClick.bind(this);\n  }\n\n  onClick(e) {\n    /* cancel this page if background is clicked */\n    if (e.target.id === \"background-input-set\") {\n      this.props.toggle();\n    }\n  }\n\n  render() {\n    if (!this.props.display) {\n      return null;\n    }\n    return (\n      <div id=\"background-input-set\" className=\"set-input-container\" onClick={this.onClick}>\n      <h1>Setup Training Details</h1>\n      <div className=\"input-container\">\n        <div className=\"input-preset\">\n          <h2>Optimizer</h2>\n          <div>\n            Learning Rate: <input id=\"learning-rate\" type=\"number\" step=\"any\" value={this.props.modelInfo.learningRate} onChange={() => this.props.update(\"learningRate\", parseFloat(document.getElementById(\"learning-rate\").value))} min=\"0\"></input>\n          </div>\n          <div className=\"d-flex flex-wrap p-2\">\n            <Option name=\"adam\" displayName=\"Adam\" selected={this.props.modelInfo.optimizer} select={(v)=>this.props.update(\"optimizer\", v)}></Option>\n            <Option name=\"sgd\" displayName=\"SGD\" selected={this.props.modelInfo.optimizer} select={(v)=>this.props.update(\"optimizer\", v)}></Option>\n            <Option name=\"rmsProp\" displayName=\"RMS Prop\" selected={this.props.modelInfo.optimizer} select={(v)=>this.props.update(\"optimizer\", v)}></Option>\n          </div>\n        </div>\n\n        <div id=\"input-blocker\" className=\"input-blocker\"></div>\n        <div className=\"input-load\">\n          <h2>Loss</h2>\n          <div className=\"d-flex flex-wrap p-2\">\n            <Option name=\"mse\" displayName=\"Mean Squared Error\" selected={this.props.modelInfo.loss} select={(v)=>this.props.update(\"loss\", v)}></Option>\n            <Option name=\"logcosh\" displayName=\"Log Cosh\" selected={this.props.modelInfo.loss} select={(v)=>this.props.update(\"loss\", v)}></Option>\n            <Option name=\"cce\" displayName=\"Categorical Crossentropy\" selected={this.props.modelInfo.loss} select={(v)=>this.props.update(\"loss\", v)}></Option>\n          </div>\n        </div>\n      </div>\n      </div>\n      );\n    }\n}","import React from 'react';\nimport {Sidebar} from \"./Sidebar.js\";\nimport {CanvasContainer} from \"./Canvas.js\";\nimport {Toolbar} from \"./Toolbar.js\";\nimport {ErrorBox} from \"./ErrorBox.js\";\nimport {SelectModel} from \"./SelectModel.js\";\nimport {LinkPage} from \"./LinkPage.js\";\nimport {SetInput} from \"./SetInput.js\";\nimport {isCyclic, isLinear, isTrainable} from \"./Utils.js\";\nimport {nodeTypes, blankModel, denseModel, convModel} from \"./ModelInfo.js\";\nimport {getModel, saveModel, startSession, updateTrain, deleteTrain, generateLink, getIDFromLink, downloadModel, loadInput} from \"./Server.js\";\nimport {TrainSetup} from \"./TrainSetup.js\";\nimport {DATASET_SHAPE} from \"./Constants.js\";\nimport cloneDeep from 'lodash/cloneDeep';\nimport './App.css';\n\nexport class App extends React.Component {\n  constructor(props) {\n    super(props);\n  \n    this.state = {\n      models: { // represent the architecture\n        0: this._model(\"input\", 0, 20, 50),\n        1: this._model(\"output\", 1, 300, 50),\n      },\n      modelInfo: {\n        epochs: \"2\",\n        batchSize: \"25\",\n        maxToken: null,\n        loss: \"cce\", // loss function\n        optimizer: \"adam\",\n        learningRate: \"0.01\",\n      },\n      selected: 0, // selected node;\n      nextID: 2, // the ID for the next new layer; incremented as model grows\n      errorMsg: null, // error message\n      errorOnce: false, // whether the current error message can be cancelled \n      trainingInfo: {\n        accuracy: null,\n        testAccuracy: null,\n        loss: null,\n        progress: null,\n        training: false, // whether the model is being trained on cloud\n      },\n      modelID: null, // ID of the model\n      sessionID: null, // ID of the training session\n      intervalID: null, // ID of the interval to be set\n      editableSelected: false, // whether an editable element of the toolbar is selected\n      selectModelPage: true, // is it in the page selecting model or main page\n      linkPage: false, // is link page on display\n      link: null, // the link for the current model\n      settingInput: false, // are we on a page to set input?\n      trainSetup: false, // are we customizing training information?\n    };\n\n    // function bindings\n    this.newModel = this.newModel.bind(this);\n    this.updateModel = this.updateModel.bind(this);\n    this.selectModel = this.selectModel.bind(this);\n    this.removeModel = this.removeModel.bind(this);\n\n    this.setEditableSelected = this.setEditableSelected.bind(this);\n    this.updateModelInfo = this.updateModelInfo.bind(this);\n    this.setError = this.setError.bind(this);\n\n    this.trainCloud = this.trainCloud.bind(this);    \n    this.startSession = this.startSession.bind(this);\n    this.updateTrain = this.updateTrain.bind(this);\n    this.cancelTrain = this.cancelTrain.bind(this);\n    this.state[\"models\"] = this._updateDependents(this.state.models);\n\n    this.loadDefaultModel = this.loadDefaultModel.bind(this);\n    this.loadModel = this.loadModel.bind(this);\n    this.downloadModel = this.downloadModel.bind(this);\n\n    this.getLink = this.getLink.bind(this);\n    this.setInput = this.setInput.bind(this);\n    this.loadDefaultInput = this.loadDefaultInput.bind(this);\n    this.loadCustomInput = this.loadCustomInput.bind(this);\n\n    this.trainSetup = this.trainSetup.bind(this);\n  }\n\n  _model(type, id, x, y) {\n    /* Helper function to make a new model (for a layer) given id and its position\n     */\n    return {\n      name: type + String(id),\n      ID: id,\n      type: type,\n      x: x,\n      y: y,\n      connectedTo: null,\n      shapeIn: null, // dependent\n      shapeOut: null, // dependent\n      activation: null,\n      parameters: cloneDeep(nodeTypes[type].defaultParameters),\n    };\n  }\n\n  model(type) {\n    /* Function to make a new model given its layer type, putting\n     * it in a random location on the upper left corner of the canvas\n     */\n    return this._model(type, this.state.nextID, 10 + Math.random() * 80, 10 + Math.random() * 80);\n  }\n  updateDependents(models) {\n    /* Given the current models, return models with the dependents\n     * (parameters updated given the independent variables) updated\n     * also reset the error (and may set some new ones given what happens in\n     * updating dependents)\n     */\n    this.setError(null, false);\n    return this._updateDependents(models);\n  }\n  _updateDependents(models) {\n    /* helper function to update members of nodes\n     * that depend on other parts of the system \n     */\n    // get the input model\n    let inputNode = models[0];\n    inputNode.shapeOut = nodeTypes[inputNode.type].shapeOut(inputNode.parameters, this.state.modelInfo, this.setError);\n    inputNode.shapeIn = inputNode.shapeOut;\n    let currentNode = inputNode;\n    let nextNode = models[inputNode.connectedTo];\n    while (currentNode.connectedTo !== null) {\n      nextNode.shapeIn = currentNode.shapeOut;\n      if (nextNode.type === \"input\") {\n        nextNode.shapeOut = nodeTypes[nextNode.type].shapeOut(nextNode.parameters, this.state.modelInfo, this.setError);\n      } else {\n        nextNode.shapeOut = nodeTypes[nextNode.type].shapeOut(nextNode.parameters, nextNode.shapeIn, this.setError);\n      }\n      \n      currentNode = nextNode;\n      nextNode = models[nextNode.connectedTo];\n    }\n    return models;\n  }\n\n  newModel(type) {\n    const oldModels = {...this.state.models};\n    let newModels = {...oldModels, [this.state.nextID]: this.model(type)};\n    newModels = this.updateDependents(newModels);\n    this.setState({\n      models: newModels,\n      nextID: this.state.nextID + 1,\n    });\n  }\n\n  selectModel(id) {\n    this.setState({\n      selected: id,\n    })\n  }\n\n  updateModel(id, dict) {\n    /* given a dict of properties to update ((name, value) pairs)\n     * updates the model of the given id\n     */\n    let models = {...this.state.models};\n    for (const key of Object.keys(dict)) {\n      models[id][key] = dict[key];\n    }\n    if (isCyclic(models)) {\n      this.setError(\"Graph cannot have loops\", false);\n      return;\n    } else if (!isLinear(models)[\"ok\"]) {\n      this.setError(isLinear(models)[\"err\"], false);\n      return;\n    } else {\n      this.setError(null, false)\n    }\n\n    models = this.updateDependents(models);\n    this.setState({\n      models: models,\n    });\n    \n  }\n\n  removeModel(id) {\n    /* given an id, removes the corresponding model\n     * and all connections to it\n     */\n\n    // get filtered models\n    let newModels = {};\n    for (const key of Object.keys(this.state.models)) {\n      if (this.state.models[key].ID !== id) {\n        newModels[key] = this.state.models[key];\n      }\n    }\n\n    for (const key of Object.keys(newModels)) {\n      if (newModels[key].connectedTo === id) {\n        newModels[key].connectedTo = null;\n      }\n    }\n\n    newModels = this.updateDependents(newModels);\n    this.setState({\n      models: newModels,\n    });\n  }\n\n  updateParameters(id, name, value, canTuple, floatOkay=false) {\n    /* given a name and a value\n     * updates the parameters of the model of the given id\n     */\n    // copy the model\n    const model = {...this.state.models[id]};\n\n    // now, important: check to ensure value is integer or tuple or integer\n    let components = String(value).split(\",\");\n\n    // do not accept empty inputs\n    if (components.length === 0) {\n      return;\n    }\n    for (var i = 0; i < components.length; i++) {\n      const num = floatOkay ? parseFloat(components[i]) : parseInt(components[i]);\n      // do not update if any member of tuple is not a number\n      if (isNaN(num)) {\n        return;\n      }\n      components[i] = num;\n    }\n    // if tuple, set array\n    if (components.length > 1) {\n      // no tuples for things that can't tuple\n      if (!canTuple) {\n        return;\n      }\n      model[\"parameters\"][name] = components;\n    } else {\n      model[\"parameters\"][name] = components[0];\n    }\n    let models = {...this.state.models}; // make a copy\n    \n    models[id] = model;\n    models = this.updateDependents(models);\n    this.setState({\n      models: models,\n    });\n  }\n\n  updateModelInfo(name, value, intOnly=false) {\n    /* update a key value pair of a model\n     * if intOnly is true, then the value must be an\n     * integer, or else it is rejected\n     */\n    \n    // reject non-ints\n    if (intOnly) {\n      if (isNaN(value) || value === \"\") {\n        return;\n      }\n    }\n    let modelInfo = this.state.modelInfo\n    modelInfo[name] = value;\n    this.setState({\n      modelInfo: modelInfo,\n    });\n  }\n\n  setError(err, once) {\n    /* sets the error message */\n    if (once) {\n      this.setState({\n        errorMsg: err,\n        errorOnce: once,\n      });\n    } else {\n      // do not override one-time messages\n      if (this.state.errorOnce && this.state.errorMsg !== null) {\n        return;\n      } else {\n        this.setState({\n          errorMsg: err,\n          errorOnce: once,\n        });\n      }\n    }\n    \n  }\n  \n  setEditableSelected(t) {\n    /* set whether an editable model is selected */\n    this.setState({\n      editableSelected: t,\n    });\n  }\n\n  trainCloud() {\n    /* train the model on cloud, if the model is \n     * well-formed\n     */\n\n    // first check if the model is linear\n    const models = this.updateDependents(this.state.models);\n    this.setState({\n      models: models,\n    })\n\n    // then we check if the model is well-formed\n    const resp = isTrainable(models);\n    if (!resp[\"ok\"]) {\n      this.setError(resp[\"err\"], true);\n      return;\n    }\n\n    // serialize model and save it to the database first\n    const serializedModel = JSON.stringify({\n      modelJSON: JSON.stringify({model: models, modelInfo: this.state.modelInfo}),\n    });\n    \n    saveModel(serializedModel).then((responseJSON) => {\n      let info = this.state.trainingInfo;\n      info[\"training\"] = true;\n      this.setState({trainingInfo:info, modelID: responseJSON['data'][\"id\"]});\n      this.selectModel(-1); // deselect any model to show training progress\n      // after it is saved, start a training session\n      this.startSession(responseJSON['data'][\"id\"]);\n    }).catch(e => {\n      this.setError(e.message, true);\n    });\n  }\n\n  startSession(id) {\n    /* start training session */\n    startSession(id).then(responseJSON => {\n      const data = responseJSON['data'];\n      // periodically retrieve latest training info\n      const intervalID = setInterval(this.updateTrain, 100);\n\n      // set the retrieved session id\n      this.setState({\n        sessionID: data['sessionID'],\n        intervalID: intervalID,\n      });\n    }).catch(e => {\n      this.setError(e.message, true);\n    });\n  }\n\n  updateTrain() {\n    /* update the information about the current training session */\n    updateTrain(this.state.sessionID).then(data => {\n      const trainingInfo = {\n        accuracy: String(Math.floor(data['accuracy']*100))+\"%\",\n        testAccuracy: String(Math.floor(data['test_accuracy']*100))+\"%\",\n        loss: Number(parseFloat(data['loss']).toFixed(3)),\n        progress: String(Math.floor(data['progress']*100))+\"%\",\n        training: !data['trained'], // whether the model is being trained on cloud\n      }\n      this.setState({trainingInfo: trainingInfo});\n      // stop updating if training is done\n      if (data['trained']) {\n        clearInterval(this.state.intervalID);\n      }\n    }).catch(e => {\n      this.setError(e.message, true);\n      this.cancelTrain();\n    });\n  }\n\n  cancelTrain() {\n    /* cancel the training session */\n    clearInterval(this.state.intervalID);\n    let trainingInfo = this.state.trainingInfo;\n    trainingInfo['training'] = false;\n    this.setState({trainingInfo:trainingInfo});\n    deleteTrain(this.state.sessionID);\n  }\n\n  loadModel(link, setError) {\n    /* load a stored model from a model's link */\n\n    // get model ID\n    getIDFromLink(link).then(modelID => {\n      // then get the model itself given the ID\n      getModel(modelID).then(modelJSON => {\n        const decoded = JSON.parse(modelJSON);\n        let modelInfo = this.state.modelInfo;\n        this.setState({\n          modelInfo: modelInfo,\n          models: decoded['model'],\n          // find the largest index\n          nextID: Math.max(...Object.keys(decoded['model']).map(key => Number(key)))+1,\n          selectModelPage: false,\n        });\n        setError(null);\n      }).catch(err => {\n        setError(err.message);\n      })\n    }).catch(err => {\n      setError(err.message);\n    });\n  }\n\n  loadDefaultModel(name) {\n    /* load one of the preset default models */\n    let model = null;\n    switch (name) {\n      case \"blank\":\n        model = blankModel;\n        break;\n      case \"dense\":\n        model = denseModel;\n        break;\n      case \"conv\":\n        model = convModel;\n        break;\n      default:\n        return;\n    }\n    this.setState({\n      nextID: Math.max(...Object.keys(model['model']).map(key => Number(key)))+1,\n      models: model['model'],\n      modelInfo: model['modelInfo'],\n      selectModelPage: false,\n    });\n\n  }\n\n  getLink() {\n    /* get a link for the current model */\n    const models = this.updateDependents(this.state.models);\n    this.setState({\n      models: models,\n    })\n    const serializedModel = JSON.stringify({\n      modelJSON: JSON.stringify({model: models, modelInfo: this.state.modelInfo}),\n    });\n    \n    // save the model first then get a link\n    saveModel(serializedModel).then(responseJSON => {\n      generateLink(responseJSON[\"data\"][\"id\"]).then( responseJSON => {\n        const link = responseJSON['data']['link'];\n        this.setState({\n          link: link,\n          linkPage: true,\n        });\n      }).catch(err => {\n        this.setError(err.message, true);\n      });\n    }).catch(err => {\n      this.setError(err.message, true);\n    });\n    \n  }\n\n  downloadModel() {\n    /* download the current model */\n\n    // first update dependent to make sure things are right\n    const models = this.updateDependents(this.state.models);\n    this.setState({\n      models: models,\n    })\n\n    // check if model is well-formed\n    const resp = isTrainable(models);\n    if (!resp[\"ok\"]) {\n      this.setError(resp[\"err\"], true);\n      return;\n    }\n\n    // save the model, then download it\n    const serializedModel = JSON.stringify({\n      modelJSON: JSON.stringify({model: models, modelInfo: this.state.modelInfo}),\n    });\n    saveModel(serializedModel).then((responseJSON) => {\n      const modelID = responseJSON['data'][\"id\"];\n      downloadModel(modelID).then(data => {\n        // create a temporary anchor element and click it\n        // to download this file\n        const element = document.createElement(\"a\");\n        const file = new Blob([data], {type: 'text/json'});\n        element.href = URL.createObjectURL(file);\n        element.download = \"model_architecture.json\";\n        element.click();\n      }).catch(e => {\n        this.setError(e.message, true);\n      })\n    }).catch(e => {\n      this.setError(e.message, true);\n    });\n  }\n\n  loadDefaultInput(name) {\n    /* load an input dataset that is preset */\n    \n    let models = this.state.models;\n    // set the parameters of the current model\n    models[0]['parameters']['data'] = name;\n    models[0]['parameters']['inputShape'] = DATASET_SHAPE[name].input;\n    models[1]['parameters']['outputShape'] = DATASET_SHAPE[name].output;\n\n    let modelInfo = this.state.modelInfo;\n    if (name === \"IMDB\")\n      modelInfo['maxToken'] = 1000;\n    this.setState({\n      // update dependent to make shapes correct\n      models: this.updateDependents(models), \n      settingInput: false,\n      modelInfo: modelInfo,\n    });\n  }\n\n  loadCustomInput(url, name, inputShape, outputShape, setError) {\n    /* load a user custom input set */\n\n    // make sure all the inputs are reasonable\n    if (inputShape.length === 0 || outputShape.length === 0) {\n      setError(\"Input and output shapes must be set\");\n      return;\n    }\n    if (name === null) {\n      setError(\"Name your dataset!\");\n      return;\n    }\n\n    // load the input from server\n    loadInput(url, name, inputShape, outputShape).catch(e => {\n      setError(e.message);\n      return;\n    }).then(data => {\n      let models = this.state.models;\n      // store them into the current model\n      models[0].parameters['data'] = data.datasetName;\n      models[0].parameters['inputShape'] = JSON.parse(data.inputShape);\n      models[0].parameters['datasetID'] = data.datasetID;\n      models[1].parameters['data'] = data.datasetName;\n      models[1].parameters['outputShape'] = JSON.parse(data.outputShape);\n      // keep shapes correct\n      models = this.updateDependents(models);\n\n      this.setState({\n        models: models,\n        settingInput: false,\n      });\n    });\n  }\n\n  setInput() {\n    /* bring up the setting input page */\n    this.setState({\n      settingInput: true,\n    });\n  }\n\n  trainSetup() {\n    /* bring up the train setup page */\n    this.setState({\n      trainSetup: true,\n    })\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n        <LinkPage display={this.state.linkPage} link={this.state.link} toggle={()=>this.setState({linkPage: false})}/>\n        <SelectModel display={this.state.selectModelPage} loadModel={this.loadModel} loadDefaultModel={this.loadDefaultModel} toggle={()=>this.setState({selectModelPage: false})}></SelectModel>\n        <SetInput display={this.state.settingInput} loadDefaultInput={this.loadDefaultInput} loadInput={this.loadCustomInput} toggle={()=>{this.setState({settingInput: false})}}></SetInput>\n        <TrainSetup display={this.state.trainSetup} toggle={()=>this.setState({trainSetup: false})} modelInfo={this.state.modelInfo} update={this.updateModelInfo}></TrainSetup>\n        <ErrorBox errorMsg={this.state.errorMsg} dismissible={this.state.errorOnce} setError={this.setError}/>\n        <div className=\"container-fluid d-flex h-100 flex-row no-margin\">\n          <Sidebar models={this.state.models} selected={this.state.selected} trainingInfo={this.state.trainingInfo} newModel={this.newModel} setError={this.setError} update={this.updateModel} setSelectModelPage={() => this.setState({selectModelPage:true})} trainCloud={this.trainCloud} cancelTrain={this.cancelTrain} getLink={this.getLink} downloadModel={this.downloadModel} setInput={this.setInput}/>\n          <div className=\"d-flex w-100 p-2 flex-column flex-grow-1 no-margin\" ref=\"canvasContainer\">\n            <CanvasContainer models={this.state.models} selected={this.state.selected} select={this.selectModel} update={this.updateModel} remove={this.removeModel} editableSelected={this.state.editableSelected}/>\n            <Toolbar trainSetup={this.trainSetup} modelInfo={this.state.modelInfo} setInputDataset={this.setInput} trainingInfo={this.state.trainingInfo} updateModelInfo={this.updateModelInfo} selected={this.state.selected} models={this.state.models} update={(name, value, canTuple, floatOkay=false) => this.updateParameters(this.state.selected, name, value, canTuple, floatOkay)} setEditableSelected={this.setEditableSelected}/>\n          </div>\n          \n        </div>\n      </React.Fragment>\n      \n    );\n  }\n}\n\nexport default App;\n","import ReactDOM from 'react-dom';\nimport React from 'react';\nimport App from './App.js';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport \"./index.css\";\n\n// the main page being loaded here: entry point\n// for the app\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root')\n);"],"sourceRoot":""}